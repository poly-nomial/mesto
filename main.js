(()=>{"use strict";function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var e=function(){function e(t,n,r,o,i,a,u){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t.name,this._link=t.link,this.cardId=t._id,this._ownerId=t.owner._id,this._userId=u,this._usersLiked=t.likes,this._numberOfLikes=t.likes.length,this._templateSelector=n,this._openImagePopup=r,this._openConfirmationPopup=o,this._deleteCard=i,this._updateLike=a}var n,r;return n=e,(r=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelector).content.cloneNode(!0)}},{key:"_toggleActiveLike",value:function(t){this._updateLike(t,this)}},{key:"_setEventListeners",value:function(){var t=this;this._likeButton.addEventListener("click",(function(e){return t._toggleActiveLike(e)})),this._deleteButton.addEventListener("click",(function(){t._openConfirmationPopup((function(){return t._deleteCard(t)}))})),this._placePic.addEventListener("click",(function(){return t._openImagePopup(t._name,t._link)}))}},{key:"createCard",value:function(){var t=this;return this._element=this._getTemplate(),this._place=this._element.querySelector(".place"),this._deleteButton=this._place.querySelector(".place__delete-button"),this._userId!=this._ownerId&&this._deleteButton.remove(),this._placePic=this._element.querySelector(".place__pic"),this._likesCounter=this._element.querySelector(".place__number-of-likes"),this._placePic.setAttribute("src",this._link),this._placePic.setAttribute("alt",this._name),this._element.querySelector(".place__name").textContent=this._name,this._likeButton=this._place.querySelector(".place__like"),this._likesCounter.textContent=this._numberOfLikes,this._usersLiked.some((function(e){return e._id===t._userId}))&&this._likeButton.classList.add("place__like_active"),this._place.setAttribute("id",this.cardId),this._setEventListeners(),this._element}},{key:"deleteCardFromDOM",value:function(){document.getElementById(this.cardId).remove()}}])&&t(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}var e,r;return e=t,(r=[{key:"open",value:function(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"_handleEscClose",value:function(t){"Escape"===t.key&&this.close()}},{key:"setEventListeners",value:function(){var t=this;this._popup.addEventListener("click",(function(e){(e.target.classList.contains("popup")||e.target.classList.contains("popup__close-btn"))&&t.close()}))}}])&&n(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(){return a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=u(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},a.apply(this,arguments)}function u(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}function c(t,e){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},c(t,e)}function s(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(p,t);var e,n,r,o,u=(r=p,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=l(r);if(o){var n=l(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return s(this,t)});function p(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),(n=u.call(this,t))._submitFunction=e,n._popupForm=n._popup.querySelector(".popup__form"),n._inputList=Array.from(n._popup.querySelectorAll(".popup__input")),n.button=n._popup.querySelector(".popup__save-btn"),n}return e=p,(n=[{key:"getInputValues",value:function(){for(var t=[],e=0;e<this._inputList.length;e++)t[e]=this._inputList[e].value;return t}},{key:"setEventListeners",value:function(){var t=this;a(l(p.prototype),"setEventListeners",this).call(this),this._popupForm.addEventListener("submit",(function(e){return t._submitFunction(e)}))}},{key:"close",value:function(){a(l(p.prototype),"close",this).call(this),this._popupForm.reset()}}])&&i(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),p}(r);function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var h=function(){function t(e,n){var r=e.items,o=e.renderer;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.items=r,this.renderer=o,this._container=document.querySelector(n)}var e,n;return e=t,(n=[{key:"renderItems",value:function(){var t=this;this.items.forEach((function(e){t.renderer(e)}))}},{key:"addItem",value:function(t){this._container.prepend(t)}}])&&f(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var d=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._inputSelector=e.inputSelector,this._invalidInputClass=e.invalidInputClass,this._buttonSelector=e.buttonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._activeErrorClass=e.activeErrorClass,this._formElement=n,this._buttonElement=n.querySelector(this._buttonSelector),this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector))}var e,n;return e=t,(n=[{key:"_hasInvalidInput",value:function(t){return t.some((function(t){return!t.validity.valid}))}},{key:"toggleButtonState",value:function(){this._hasInvalidInput(this._inputList)?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.removeAttribute("disabled",!0))}},{key:"_showErrorMessage",value:function(t,e){var n=this._formElement.querySelector(".popup__".concat(t.id,"-error"));n.textContent=e,n.classList.add(this._activeErrorClass),t.classList.add(this._invalidInputClass)}},{key:"hideErrorMessage",value:function(t){var e=this._formElement.querySelector(".popup__".concat(t.id,"-error"));e.textContent="",e.classList.remove(this._activeErrorClass),t.classList.remove(this._invalidInputClass)}},{key:"resetValidationErrors",value:function(){var t=this;this._inputList.forEach((function(e){t.hideErrorMessage(e)}))}},{key:"_checkInputValidity",value:function(t){t.validity.valid?this.hideErrorMessage(t):this._showErrorMessage(t,t.validationMessage)}},{key:"_setEventListeners",value:function(){var t=this;this.toggleButtonState(),this._inputList.forEach((function(e){e.addEventListener("input",(function(){t._checkInputValidity(e),t.toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._formElement.addEventListener("submit",(function(t){t.preventDefault()})),this._setEventListeners()}}])&&y(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function m(){return m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=b(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},m.apply(this,arguments)}function b(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=E(t)););return t}function g(t,e){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},g(t,e)}function k(t,e){if(e&&("object"===_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function E(t){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},E(t)}var w=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g(t,e)}(a,t);var e,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=E(r);if(o){var n=E(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return k(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,t))._photoElement=e._popup.querySelector(".popup__photo"),e._titleElement=e._popup.querySelector(".popup__photo-title"),e}return e=a,(n=[{key:"open",value:function(t,e){this._photoElement.setAttribute("src",e),this._photoElement.setAttribute("alt",t),this._titleElement.textContent=t,m(E(a.prototype),"open",this).call(this)}}])&&v(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(r);function S(t){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(t)}function C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function O(){return O="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=j(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},O.apply(this,arguments)}function j(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=A(t)););return t}function L(t,e){return L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},L(t,e)}function P(t,e){if(e&&("object"===S(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return I(t)}function I(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function A(t){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},A(t)}var q=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&L(t,e)}(a,t);var e,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=A(r);if(o){var n=A(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return P(this,t)});function a(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,t)).handleConfirm=e,n._executeConfirmedAction=n.executeConfirmedAction.bind(I(n)),n.button=n._popup.querySelector(".popup__save-btn"),n}return e=a,(n=[{key:"setNewConfirmedAction",value:function(t){this.handleConfirm=t}},{key:"executeConfirmedAction",value:function(){this.handleConfirm(),this.close()}},{key:"setEventListeners",value:function(){O(A(a.prototype),"setEventListeners",this).call(this),this.button.addEventListener("click",this._executeConfirmedAction)}}])&&C(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(r);function R(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function T(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var x=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._userNameElement=document.querySelector(e),this._userDescriptionElement=document.querySelector(n),this._userAvatarElement=document.querySelector(r)}var e,n;return e=t,(n=[{key:"getUserInfo",value:function(){return{name:this._userNameElement.textContent,about:this._userDescriptionElement.textContent,avatar:this._userAvatarElement.style["background-image"]}}},{key:"setUserInfo",value:function(t){var e,n,r=(n=4,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(e,n)||function(t,e){if(t){if("string"==typeof t)return R(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?R(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1],a=r[2],u=r[3];this._userNameElement.textContent=o,this._userDescriptionElement.textContent=i,this._userAvatarElement.style["background-image"]="url(".concat(a,")"),this.userId=u}}])&&T(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function D(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function B(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var U=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._baseUrl=e.baseUrl,this._token=e.headers.authorization,this._cohort="cohort-50"}var e,n;return e=t,(n=[{key:"getUserInfo",value:function(){var t=this;return fetch("".concat(this._baseUrl,"/").concat(this._cohort,"/users/me"),{headers:{authorization:this._token,"Content-Type":"application/json"}}).then((function(e){return t._getResponseData(e)}))}},{key:"getCardsFromServer",value:function(){var t=this;return fetch("https://mesto.nomoreparties.co/v1/".concat(this._cohort,"/cards"),{headers:{authorization:this._token,"Content-Type":"application/json"}}).then((function(e){return t._getResponseData(e)}))}},{key:"editUserInfo",value:function(t){var e,n,r=this,o=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(e,n)||function(t,e){if(t){if("string"==typeof t)return D(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],a=o[1];return fetch("https://mesto.nomoreparties.co/v1/".concat(this._cohort,"/users/me"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:i,about:a})}).then((function(t){return r._getResponseData(t)}))}},{key:"postNewCard",value:function(t){var e=this;return fetch("https://mesto.nomoreparties.co/v1/".concat(this._cohort,"/cards"),{method:"POST",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:t.name,link:t.link})}).then((function(t){return e._getResponseData(t)}))}},{key:"deleteCard",value:function(t){var e=this;return fetch("https://mesto.nomoreparties.co/v1/".concat(this._cohort,"/cards/").concat(t),{method:"DELETE",headers:{authorization:this._token,"Content-Type":"application/json"}}).then((function(t){return e._getResponseData(t)}))}},{key:"likeCard",value:function(t){var e=this;return fetch("https://mesto.nomoreparties.co/v1/".concat(this._cohort,"/cards/").concat(t,"/likes"),{method:"PUT",headers:{authorization:this._token,"Content-Type":"application/json"}}).then((function(t){return e._getResponseData(t)}))}},{key:"dislikeCard",value:function(t){var e=this;return fetch("https://mesto.nomoreparties.co/v1/".concat(this._cohort,"/cards/").concat(t,"/likes"),{method:"DELETE",headers:{authorization:this._token,"Content-Type":"application/json"}}).then((function(t){return e._getResponseData(t)}))}},{key:"updateAvatar",value:function(t){var e=this;return fetch("https://mesto.nomoreparties.co/v1/".concat(this._cohort,"/users/me/avatar"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({avatar:t})}).then((function(t){return e._getResponseData(t)}))}},{key:"_getResponseData",value:function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}}])&&B(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),V={formSelector:".popup__form",inputSelector:".popup__input",invalidInputClass:"popup__input_invalid",buttonSelector:".popup__save-btn",inactiveButtonClass:"popup__save-btn_inactive",activeErrorClass:"popup__input-error_active"},M=document.querySelector(".popup__input_type_user-name"),N=document.querySelector(".popup__input_type_user-desc"),z=(document.querySelector(".popup__input_type_place-name"),document.querySelector(".popup__input_type_place-link"),document.querySelector(".popup__input_type_avatar-link"),document.querySelector(".profile__edit-button")),F=document.querySelector(".profile__add-button"),J=document.querySelector(".avatar__edit-pic"),$=new U({baseUrl:"https://nomoreparties.co/v1/",headers:{authorization:"85ece6ec-ad42-4595-ab64-f4ab4791389f","Content-Type":"application/json"}}),H=new d(V,document.querySelector(".popup_type_add-place").querySelector(V.formSelector)),G=new d(V,document.querySelector(".popup_type_edit-profile").querySelector(V.formSelector)),K=new d(V,document.querySelector(".popup_type_change-avatar").querySelector(V.formSelector)),Q=new x(".profile__user-name",".profile__user-description",".avatar"),W=new w(".popup_type_photo-view"),X=new q(".popup_type_confirmation",(function(){}));function Y(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Z=new h({items:[],renderer:function(){}},".places"),tt=new p(".popup_type_edit-profile",(function(t){t.preventDefault(),ut(!0,tt.button);var e=tt.getInputValues();$.editUserInfo(e).then((function(t){Q.setUserInfo([t.name,t.about,t.avatar,t._id]),tt.close()})).catch((function(t){return console.log(t)})).finally((function(){return ut(!1,tt.button)}))})),et=new p(".popup_type_add-place",(function(t){t.preventDefault(),ut(!0,et.button);var e=et.getInputValues(),n={name:e[0],link:e[1]};$.postNewCard(n).then((function(t){Z.items=[t],Z.renderer=Z.renderItems(),et.close()})).catch((function(t){return console.log(t)})).finally((function(){return ut(!1,et.button)}))})),nt=new p(".popup_type_change-avatar",(function(t){t.preventDefault(),ut(!0,nt.button);var e,n,r=(e=nt.getInputValues(),n=1,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(e,n)||function(t,e){if(t){if("string"==typeof t)return Y(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Y(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];$.updateAvatar(r).then((function(t){Q.setUserInfo([t.name,t.about,t.avatar,t._id]),nt.close()})).catch((function(t){return console.log(t)})).finally((function(){return ut(!1,nt.button)}))}));$.getUserInfo().then((function(t){Q.setUserInfo([t.name,t.about,t.avatar,t._id])})).then((function(){$.getCardsFromServer().then((function(t){t.reverse(),Z.items=t,Z.renderer=function(t){Z.addItem(new e(t,"#place-template",rt,ot,it,at,Q.userId).createCard())},Z.renderItems()})).catch((function(t){return console.log(t)}))})).catch((function(t){return console.log(t)})),W.setEventListeners(),tt.setEventListeners(),et.setEventListeners(),X.setEventListeners(),nt.setEventListeners(),z.addEventListener("click",(function(){var t=Q.getUserInfo();M.value=t.name,N.value=t.about,G.resetValidationErrors(),G.toggleButtonState(),tt.open()})),F.addEventListener("click",(function(){H.resetValidationErrors(),H.toggleButtonState(),et.open()})),J.addEventListener("click",(function(){K.resetValidationErrors(),K.toggleButtonState(),nt.open()})),H.enableValidation(),G.enableValidation(),K.enableValidation();var rt=function(t,e){W.open(t,e)},ot=function(t){X.setNewConfirmedAction(t),X.open()};function it(t){$.deleteCard(t.cardId).then((function(){return t.deleteCardFromDOM()})).catch((function(t){return console.log(t)}))}var at=function(t,e){var n;t.target.classList.contains("place__like_active")?(n=e.cardId,$.dislikeCard(n)).then((function(e){t.target.classList.remove("place__like_active"),t.target.nextElementSibling.textContent=e.likes.length})).catch((function(t){return console.log(t)})):function(t){return $.likeCard(t)}(e.cardId).then((function(e){t.target.classList.add("place__like_active"),t.target.nextElementSibling.textContent=e.likes.length})).catch((function(t){return console.log(t)}))};function ut(t,e){e.textContent=t?"Сохранение…":"Сохранить"}})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQUksc0JBQ3pCaEIsRUFBSTJCLE9BQU8ySixtQkFBbUIxSyxZQUFjMEksRUFBS2xLLE1BQU1FLE1BQzFELElBQ0FrSyxPQUFNLFNBQUNDLEdBQUQsT0FBU0MsUUFBUUMsSUFBSUYsRUFBckIsR0FFZCxFQUdELFNBQVNOLEdBQWNxQyxFQUFXQyxHQUM5QkEsRUFBYzdLLFlBQWM0SyxFQUFZLGNBQWdCLFdBQzNELEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9jYXJkLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3BvcHVwLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvc2VjdGlvbi5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9mb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy91c2VySW5mby5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9hcGkuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcGFnZXMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNsYXNzIENhcmQge1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgY2FyZCwgXHJcbiAgICAgICAgdGVtcGxhdGVTZWxlY3RvciwgXHJcbiAgICAgICAgb3BlblBob3RvUG9wdXBGdW5jdGlvbiwgXHJcbiAgICAgICAgb3BlbkNvbmZpcm1hdGlvblBvcHVwRnVuY3Rpb24sIFxyXG4gICAgICAgIGRlbGV0ZUNhcmRGdW5jdGlvbixcclxuICAgICAgICB1cGRhdGVMaWtlRnVuY3Rpb24sXHJcbiAgICAgICAgdXNlcklkXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgdGhpcy5fbmFtZSA9IGNhcmQubmFtZTtcclxuICAgICAgICB0aGlzLl9saW5rID0gY2FyZC5saW5rO1xyXG4gICAgICAgIHRoaXMuY2FyZElkID0gY2FyZC5faWQ7XHJcbiAgICAgICAgdGhpcy5fb3duZXJJZCA9IGNhcmQub3duZXIuX2lkO1xyXG4gICAgICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcclxuICAgICAgICB0aGlzLl91c2Vyc0xpa2VkID0gY2FyZC5saWtlcztcclxuICAgICAgICB0aGlzLl9udW1iZXJPZkxpa2VzID0gY2FyZC5saWtlcy5sZW5ndGg7XHJcbiAgICAgICAgdGhpcy5fdGVtcGxhdGVTZWxlY3RvciA9IHRlbXBsYXRlU2VsZWN0b3I7XHJcbiAgICAgICAgdGhpcy5fb3BlbkltYWdlUG9wdXAgPSBvcGVuUGhvdG9Qb3B1cEZ1bmN0aW9uO1xyXG4gICAgICAgIHRoaXMuX29wZW5Db25maXJtYXRpb25Qb3B1cCA9IG9wZW5Db25maXJtYXRpb25Qb3B1cEZ1bmN0aW9uO1xyXG4gICAgICAgIHRoaXMuX2RlbGV0ZUNhcmQgPSBkZWxldGVDYXJkRnVuY3Rpb247XHJcbiAgICAgICAgdGhpcy5fdXBkYXRlTGlrZSA9IHVwZGF0ZUxpa2VGdW5jdGlvbjtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3RlbXBsYXRlU2VsZWN0b3IpLmNvbnRlbnQuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxuICAgIH1cclxuXHJcbiAgICBfdG9nZ2xlQWN0aXZlTGlrZShldnQpIHtcclxuICAgICAgICB0aGlzLl91cGRhdGVMaWtlKGV2dCwgdGhpcyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2dCkgPT4gdGhpcy5fdG9nZ2xlQWN0aXZlTGlrZShldnQpKTtcclxuICAgICAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFjdGlvbiA9ICgpID0+IHRoaXMuX2RlbGV0ZUNhcmQodGhpcyk7XHJcbiAgICAgICAgICAgIHRoaXMuX29wZW5Db25maXJtYXRpb25Qb3B1cChhY3Rpb24pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuX3BsYWNlUGljLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5fb3BlbkltYWdlUG9wdXAodGhpcy5fbmFtZSwgdGhpcy5fbGluaykpXHJcbiAgICB9XHJcblxyXG4gICAgY3JlYXRlQ2FyZCgpIHtcclxuICAgICAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgICAgICB0aGlzLl9wbGFjZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLnBsYWNlJyk7XHJcbiAgICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fcGxhY2UucXVlcnlTZWxlY3RvcignLnBsYWNlX19kZWxldGUtYnV0dG9uJyk7XHJcbiAgICAgICAgaWYgKHRoaXMuX3VzZXJJZCAhPSB0aGlzLl9vd25lcklkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5yZW1vdmUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fcGxhY2VQaWMgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZV9fcGljJyk7XHJcbiAgICAgICAgdGhpcy5fbGlrZXNDb3VudGVyID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucGxhY2VfX251bWJlci1vZi1saWtlcycpO1xyXG4gICAgICAgIHRoaXMuX3BsYWNlUGljLnNldEF0dHJpYnV0ZSgnc3JjJywgdGhpcy5fbGluayk7XHJcbiAgICAgICAgdGhpcy5fcGxhY2VQaWMuc2V0QXR0cmlidXRlKCdhbHQnLCB0aGlzLl9uYW1lKTtcclxuICAgICAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZV9fbmFtZScpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgICAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fcGxhY2UucXVlcnlTZWxlY3RvcignLnBsYWNlX19saWtlJyk7XHJcbiAgICAgICAgdGhpcy5fbGlrZXNDb3VudGVyLnRleHRDb250ZW50ID0gdGhpcy5fbnVtYmVyT2ZMaWtlcztcclxuICAgICAgICBpZiAodGhpcy5fdXNlcnNMaWtlZC5zb21lKHVzZXIgPT4gdXNlci5faWQgPT09IHRoaXMuX3VzZXJJZCkpIHtcclxuICAgICAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdwbGFjZV9fbGlrZV9hY3RpdmUnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fcGxhY2Uuc2V0QXR0cmlidXRlKCdpZCcsIHRoaXMuY2FyZElkKTtcclxuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZUNhcmRGcm9tRE9NKCkge1xyXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuY2FyZElkKS5yZW1vdmUoKTtcclxuICAgIH1cclxufSIsImV4cG9ydCBjbGFzcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcclxuICAgIH07XHJcblxyXG4gICAgb3BlbigpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKCdwb3B1cF9vcGVuZWQnKTtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgfTtcclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdwb3B1cF9vcGVuZWQnKTtcclxuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xyXG4gICAgICAgIGlmIChldnQua2V5ID09PSAnRXNjYXBlJykge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldnQpID0+IHtcclxuICAgICAgICAgICAgaWYgKChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXAnKSkgfHwgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9fY2xvc2UtYnRuJykpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9ICk7XHJcbiAgICB9O1xyXG59IiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9wb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBzdWJtaXRGdW5jdGlvbikge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX3N1Ym1pdEZ1bmN0aW9uID0gc3VibWl0RnVuY3Rpb247XHJcbiAgICAgICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtJyk7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX2lucHV0JykpO1xyXG4gICAgICAgIHRoaXMuYnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19zYXZlLWJ0bicpO1xyXG4gICAgfTtcclxuXHJcbiAgICBnZXRJbnB1dFZhbHVlcygpIHtcclxuICAgICAgICBjb25zdCBpbnB1dFZhbHVlcyA9IFtdO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5faW5wdXRMaXN0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlucHV0VmFsdWVzW2ldID0gdGhpcy5faW5wdXRMaXN0W2ldLnZhbHVlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIGlucHV0VmFsdWVzO1xyXG4gICAgfTtcclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB0aGlzLl9zdWJtaXRGdW5jdGlvbihldnQpKTtcclxuICAgIH07XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcclxuICAgICAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICAgIH07XHJcbn0iLCJleHBvcnQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuaXRlbXMgPSBpdGVtcztcclxuICAgICAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgICB9O1xyXG5cclxuICAgIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgICAgIHRoaXMuaXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJlcihpdGVtKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgICBjb25zdHJ1Y3RvcihzZWxlY3RvcnMsIGZvcm1FbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNlbGVjdG9ycy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgICAgIHRoaXMuX2ludmFsaWRJbnB1dENsYXNzID0gc2VsZWN0b3JzLmludmFsaWRJbnB1dENsYXNzO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvblNlbGVjdG9yID0gc2VsZWN0b3JzLmJ1dHRvblNlbGVjdG9yO1xyXG4gICAgICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZWxlY3RvcnMuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgICAgICB0aGlzLl9hY3RpdmVFcnJvckNsYXNzID0gc2VsZWN0b3JzLmFjdGl2ZUVycm9yQ2xhc3M7XHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9idXR0b25TZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpKTtcclxuICAgIH1cclxuXHJcbiAgICBfaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkge1xyXG4gICAgICAgIHJldHVybiBpbnB1dExpc3Quc29tZShlbGVtID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuICFlbGVtLnZhbGlkaXR5LnZhbGlkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgICAgIGlmKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dExpc3QpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgdHJ1ZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnLCB0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX3Nob3dFcnJvck1lc3NhZ2UoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcclxuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAucG9wdXBfXyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9hY3RpdmVFcnJvckNsYXNzKTtcclxuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnZhbGlkSW5wdXRDbGFzcyk7XHJcbiAgICB9XHJcblxyXG4gICAgaGlkZUVycm9yTWVzc2FnZShpbnB1dEVsZW1lbnQpIHtcclxuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAucG9wdXBfXyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2FjdGl2ZUVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2ludmFsaWRJbnB1dENsYXNzKTtcclxuICAgIH1cclxuXHJcbiAgICByZXNldFZhbGlkYXRpb25FcnJvcnMoKSB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goaW5wdXQgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmhpZGVFcnJvck1lc3NhZ2UoaW5wdXQpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgICAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9zaG93RXJyb3JNZXNzYWdlKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmhpZGVFcnJvck1lc3NhZ2UoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaChlbGVtID0+IHtcclxuICAgICAgICAgICAgZWxlbS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShlbGVtKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZXZ0ID0+IHtcclxuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9wb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX3Bob3RvRWxlbWVudCA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fcGhvdG8nKTtcclxuICAgICAgICB0aGlzLl90aXRsZUVsZW1lbnQgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3Bob3RvLXRpdGxlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbihwaG90b05hbWUsIHBob3RvTGluaykge1xyXG4gICAgICAgIHRoaXMuX3Bob3RvRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3NyYycsIHBob3RvTGluayk7XHJcbiAgICAgICAgdGhpcy5fcGhvdG9FbGVtZW50LnNldEF0dHJpYnV0ZSgnYWx0JywgcGhvdG9OYW1lKTtcclxuICAgICAgICB0aGlzLl90aXRsZUVsZW1lbnQudGV4dENvbnRlbnQgPSBwaG90b05hbWU7XHJcbiAgICAgICAgc3VwZXIub3BlbigpO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9wb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUNvbmZpcm1GdW5jdGlvbikge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuaGFuZGxlQ29uZmlybSA9IGhhbmRsZUNvbmZpcm1GdW5jdGlvbjtcclxuICAgICAgICB0aGlzLl9leGVjdXRlQ29uZmlybWVkQWN0aW9uID0gdGhpcy5leGVjdXRlQ29uZmlybWVkQWN0aW9uLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5idXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3NhdmUtYnRuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0TmV3Q29uZmlybWVkQWN0aW9uKGFjdGlvbikge1xyXG4gICAgICAgIHRoaXMuaGFuZGxlQ29uZmlybSA9IGFjdGlvbjtcclxuICAgIH1cclxuXHJcbiAgICBleGVjdXRlQ29uZmlybWVkQWN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuaGFuZGxlQ29uZmlybSgpO1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgIHRoaXMuYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fZXhlY3V0ZUNvbmZpcm1lZEFjdGlvbik7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgY2xhc3MgVXNlckluZm8ge1xyXG4gICAgY29uc3RydWN0b3IodXNlck5hbWVTZWxlY3RvciwgdXNlckRlc2NyaXB0aW9uU2VsZWN0b3IsIHVzZXJBdmF0YXJTZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuX3VzZXJOYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlck5hbWVTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fdXNlckRlc2NyaXB0aW9uRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckRlc2NyaXB0aW9uU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX3VzZXJBdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyQXZhdGFyU2VsZWN0b3IpO1xyXG4gICAgfTtcclxuXHJcbiAgICBnZXRVc2VySW5mbygpIHtcclxuICAgICAgICBjb25zdCB1c2VySW5mbyA9IHtcclxuICAgICAgICAgICAgbmFtZTogdGhpcy5fdXNlck5hbWVFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICAgICAgICBhYm91dDogdGhpcy5fdXNlckRlc2NyaXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgICAgICAgICAgYXZhdGFyOiB0aGlzLl91c2VyQXZhdGFyRWxlbWVudC5zdHlsZVsnYmFja2dyb3VuZC1pbWFnZSddXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHVzZXJJbmZvO1xyXG4gICAgfTtcclxuXHJcbiAgICBzZXRVc2VySW5mbyhbdXNlck5hbWUsIHVzZXJEZXNjcmlwdGlvbiwgdXNlckF2YXRhckxpbmssIHVzZXJJZF0pIHtcclxuICAgICAgICB0aGlzLl91c2VyTmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSB1c2VyTmFtZTtcclxuICAgICAgICB0aGlzLl91c2VyRGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50ID0gdXNlckRlc2NyaXB0aW9uO1xyXG4gICAgICAgIHRoaXMuX3VzZXJBdmF0YXJFbGVtZW50LnN0eWxlW2BiYWNrZ3JvdW5kLWltYWdlYF0gPSBgdXJsKCR7dXNlckF2YXRhckxpbmt9KWA7XHJcbiAgICAgICAgdGhpcy51c2VySWQgPSB1c2VySWQ7XHJcbiAgICB9O1xyXG59IiwiZXhwb3J0IGNsYXNzIEFwaSB7XHJcbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICAgICAgdGhpcy5fYmFzZVVybCA9IG9wdGlvbnMuYmFzZVVybDtcclxuICAgICAgICB0aGlzLl90b2tlbiA9IG9wdGlvbnMuaGVhZGVycy5hdXRob3JpemF0aW9uO1xyXG4gICAgICAgIHRoaXMuX2NvaG9ydCA9IFwiY29ob3J0LTUwXCI7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vJHt0aGlzLl9jb2hvcnR9L3VzZXJzL21lYCwge1xyXG4gICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAnYXV0aG9yaXphdGlvbic6IHRoaXMuX3Rva2VuLFxyXG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4ocmVzID0+IHRoaXMuX2dldFJlc3BvbnNlRGF0YShyZXMpKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRDYXJkc0Zyb21TZXJ2ZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGBodHRwczovL21lc3RvLm5vbW9yZXBhcnRpZXMuY28vdjEvJHt0aGlzLl9jb2hvcnR9L2NhcmRzYCwge1xyXG4gICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAnYXV0aG9yaXphdGlvbic6IHRoaXMuX3Rva2VuLFxyXG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4ocmVzID0+IHRoaXMuX2dldFJlc3BvbnNlRGF0YShyZXMpKTtcclxuICAgIH1cclxuXHJcbiAgICBlZGl0VXNlckluZm8oW25ld1VzZXJOYW1lLCBuZXdVc2VyRGVzY3JpcHRpb25dKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGBodHRwczovL21lc3RvLm5vbW9yZXBhcnRpZXMuY28vdjEvJHt0aGlzLl9jb2hvcnR9L3VzZXJzL21lYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6ICdQQVRDSCcsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgICAgICdhdXRob3JpemF0aW9uJzogdGhpcy5fdG9rZW4sXHJcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IG5ld1VzZXJOYW1lLFxyXG4gICAgICAgICAgICAgICAgYWJvdXQ6IG5ld1VzZXJEZXNjcmlwdGlvblxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB0aGlzLl9nZXRSZXNwb25zZURhdGEocmVzKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIHBvc3ROZXdDYXJkKG5ld0NhcmQpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYGh0dHBzOi8vbWVzdG8ubm9tb3JlcGFydGllcy5jby92MS8ke3RoaXMuX2NvaG9ydH0vY2FyZHNgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAnYXV0aG9yaXphdGlvbic6IHRoaXMuX3Rva2VuLFxyXG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBuZXdDYXJkLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBsaW5rOiBuZXdDYXJkLmxpbmtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbihyZXMgPT4gdGhpcy5fZ2V0UmVzcG9uc2VEYXRhKHJlcykpO1xyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGBodHRwczovL21lc3RvLm5vbW9yZXBhcnRpZXMuY28vdjEvJHt0aGlzLl9jb2hvcnR9L2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgJ2F1dGhvcml6YXRpb24nOiB0aGlzLl90b2tlbixcclxuICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbihyZXMgPT4gdGhpcy5fZ2V0UmVzcG9uc2VEYXRhKHJlcykpO1xyXG4gICAgfVxyXG5cclxuICAgIGxpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgaHR0cHM6Ly9tZXN0by5ub21vcmVwYXJ0aWVzLmNvL3YxLyR7dGhpcy5fY29ob3J0fS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgICAgICdhdXRob3JpemF0aW9uJzogdGhpcy5fdG9rZW4sXHJcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbihyZXMgPT4gdGhpcy5fZ2V0UmVzcG9uc2VEYXRhKHJlcykpO1xyXG4gICAgfVxyXG5cclxuICAgIGRpc2xpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgaHR0cHM6Ly9tZXN0by5ub21vcmVwYXJ0aWVzLmNvL3YxLyR7dGhpcy5fY29ob3J0fS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgICAgICdhdXRob3JpemF0aW9uJzogdGhpcy5fdG9rZW4sXHJcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbihyZXMgPT4gdGhpcy5fZ2V0UmVzcG9uc2VEYXRhKHJlcykpO1xyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZUF2YXRhcihuZXdBdmF0YXJMaW5rKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGBodHRwczovL21lc3RvLm5vbW9yZXBhcnRpZXMuY28vdjEvJHt0aGlzLl9jb2hvcnR9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAnYXV0aG9yaXphdGlvbic6IHRoaXMuX3Rva2VuLFxyXG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBhdmF0YXI6IG5ld0F2YXRhckxpbmtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbihyZXMgPT4gdGhpcy5fZ2V0UmVzcG9uc2VEYXRhKHJlcykpO1xyXG4gICAgfVxyXG5cclxuICAgIF9nZXRSZXNwb25zZURhdGEocmVzKSB7XHJcbiAgICAgICAgaWYgKCFyZXMub2spIHtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsImltcG9ydCB7IEZvcm1WYWxpZGF0b3IgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9mb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCB7IFBvcHVwV2l0aEltYWdlIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvcG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IHsgUG9wdXBXaXRoQ29uZmlybWF0aW9uIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvcG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XHJcbmltcG9ydCB7IFVzZXJJbmZvIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvdXNlckluZm8uanNcIjtcclxuaW1wb3J0IHsgQXBpIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvYXBpLmpzXCI7XHJcblxyXG5cclxuZXhwb3J0IGNvbnN0IHNlbGVjdG9ycyA9IHtcclxuICAgIGZvcm1TZWxlY3RvcjogJy5wb3B1cF9fZm9ybScsXHJcbiAgICBpbnB1dFNlbGVjdG9yOiAnLnBvcHVwX19pbnB1dCcsXHJcbiAgICBpbnZhbGlkSW5wdXRDbGFzczogJ3BvcHVwX19pbnB1dF9pbnZhbGlkJyxcclxuICAgIGJ1dHRvblNlbGVjdG9yOiAnLnBvcHVwX19zYXZlLWJ0bicsXHJcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiAgJ3BvcHVwX19zYXZlLWJ0bl9pbmFjdGl2ZScsXHJcbiAgICBhY3RpdmVFcnJvckNsYXNzOiAncG9wdXBfX2lucHV0LWVycm9yX2FjdGl2ZSdcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCB1c2VyTmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX3VzZXItbmFtZScpO1xyXG5leHBvcnQgY29uc3QgdXNlckRlc2NJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV91c2VyLWRlc2MnKTtcclxuZXhwb3J0IGNvbnN0IHBsYWNlTmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX3BsYWNlLW5hbWUnKTtcclxuZXhwb3J0IGNvbnN0IHBsYWNlTGlua0lucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX3BsYWNlLWxpbmsnKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhckxpbmtJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV9hdmF0YXItbGluaycpO1xyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQtYnV0dG9uJyk7XHJcbmV4cG9ydCBjb25zdCBwaG90b0FkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtYnV0dG9uJyk7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmF2YXRhcl9fZWRpdC1waWMnKTtcclxuXHJcbmV4cG9ydCBjb25zdCB0b2tlbiA9IFwiODVlY2U2ZWMtYWQ0Mi00NTk1LWFiNjQtZjRhYjQ3OTEzODlmXCI7XHJcblxyXG5leHBvcnQgY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgICBiYXNlVXJsOiAnaHR0cHM6Ly9ub21vcmVwYXJ0aWVzLmNvL3YxLycsXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgJ2F1dGhvcml6YXRpb24nOiB0b2tlbixcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgfVxyXG59KVxyXG5cclxuZXhwb3J0IGNvbnN0IHBvcHVwQWRkUGxhY2VWYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2VsZWN0b3JzLCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9hZGQtcGxhY2UnKS5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy5mb3JtU2VsZWN0b3IpKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwb3B1cEVkaXRQcm9maWxlVmFsaWRhdGlvbiA9IG5ldyBGb3JtVmFsaWRhdG9yKHNlbGVjdG9ycywgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfZWRpdC1wcm9maWxlJykucXVlcnlTZWxlY3RvcihzZWxlY3RvcnMuZm9ybVNlbGVjdG9yKSk7XHJcblxyXG5leHBvcnQgY29uc3QgcG9wdXBOZXdBdmF0YXJWYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2VsZWN0b3JzLCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9jaGFuZ2UtYXZhdGFyJykucXVlcnlTZWxlY3RvcihzZWxlY3RvcnMuZm9ybVNlbGVjdG9yKSk7XHJcblxyXG5leHBvcnQgY29uc3QgdXNlclByb2ZpbGUgPSBuZXcgVXNlckluZm8oJy5wcm9maWxlX191c2VyLW5hbWUnLCAnLnByb2ZpbGVfX3VzZXItZGVzY3JpcHRpb24nLCAnLmF2YXRhcicpO1xyXG5cclxuZXhwb3J0IGNvbnN0IHBob3RvVmlld1BvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKCcucG9wdXBfdHlwZV9waG90by12aWV3Jyk7XHJcblxyXG5leHBvcnQgY29uc3QgY29uZmlybWF0aW9uUG9wdXAgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKCcucG9wdXBfdHlwZV9jb25maXJtYXRpb24nLCAoKSA9PiB7fSk7IiwiaW1wb3J0ICcuL2luZGV4LmNzcyc7XHJcbmltcG9ydCB7IENhcmQgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9jYXJkLmpzXCI7XHJcbmltcG9ydCB7IFBvcHVwV2l0aEZvcm0gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9wb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCB7IFNlY3Rpb24gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9zZWN0aW9uLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgICB1c2VyTmFtZUlucHV0LFxyXG4gICAgdXNlckRlc2NJbnB1dCxcclxuICAgIHByb2ZpbGVFZGl0QnV0dG9uLFxyXG4gICAgcGhvdG9BZGRCdXR0b24sXHJcbiAgICBhdmF0YXJFZGl0QnV0dG9uLFxyXG4gICAgYXBpLFxyXG4gICAgcG9wdXBBZGRQbGFjZVZhbGlkYXRpb24sXHJcbiAgICBwb3B1cEVkaXRQcm9maWxlVmFsaWRhdGlvbixcclxuICAgIHBvcHVwTmV3QXZhdGFyVmFsaWRhdGlvbixcclxuICAgIHVzZXJQcm9maWxlLFxyXG4gICAgcGhvdG9WaWV3UG9wdXAsXHJcbiAgICBjb25maXJtYXRpb25Qb3B1cCxcclxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcblxyXG5jb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKHsgaXRlbXM6IFtdLCByZW5kZXJlcjogKCkgPT4ge30gfSwgJy5wbGFjZXMnKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKCcucG9wdXBfdHlwZV9lZGl0LXByb2ZpbGUnLCAoZXZ0KSA9PiB7XHJcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIHJlbmRlckxvYWRpbmcodHJ1ZSwgcHJvZmlsZVBvcHVwLmJ1dHRvbik7XHJcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHByb2ZpbGVQb3B1cC5nZXRJbnB1dFZhbHVlcygpO1xyXG4gICAgYXBpLmVkaXRVc2VySW5mbyhpbnB1dFZhbHVlcylcclxuICAgICAgICAudGhlbihkYXRhID0+IHtcclxuICAgICAgICAgICAgdXNlclByb2ZpbGUuc2V0VXNlckluZm8oW2RhdGEubmFtZSwgZGF0YS5hYm91dCwgZGF0YS5hdmF0YXIsIGRhdGEuX2lkXSk7XHJcbiAgICAgICAgICAgIHByb2ZpbGVQb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHJlbmRlckxvYWRpbmcoZmFsc2UsIHByb2ZpbGVQb3B1cC5idXR0b24pKTtcclxufSk7XHJcblxyXG5jb25zdCBuZXdQbGFjZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oJy5wb3B1cF90eXBlX2FkZC1wbGFjZScsIChldnQpID0+IHtcclxuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgcmVuZGVyTG9hZGluZyh0cnVlLCBuZXdQbGFjZVBvcHVwLmJ1dHRvbik7XHJcbiAgICBjb25zdCBuZXdQbGFjZUlucHV0cyA9IG5ld1BsYWNlUG9wdXAuZ2V0SW5wdXRWYWx1ZXMoKTtcclxuICAgIGNvbnN0IGFkZGVkQ2FyZCA9IHtcclxuICAgICAgICBuYW1lOiBuZXdQbGFjZUlucHV0c1swXSxcclxuICAgICAgICBsaW5rOiBuZXdQbGFjZUlucHV0c1sxXSxcclxuICAgIH07XHJcbiAgICBhcGkucG9zdE5ld0NhcmQoYWRkZWRDYXJkKVxyXG4gICAgICAgIC50aGVuKGRhdGEgPT4ge1xyXG4gICAgICAgICAgICBjYXJkU2VjdGlvbi5pdGVtcyA9IFtkYXRhXTtcclxuICAgICAgICAgICAgY2FyZFNlY3Rpb24ucmVuZGVyZXIgPSBcclxuICAgICAgICAgICAgY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoKTsgLy9hZGRJdGVtINCy0YvQt9GL0LLQsNC10YLRgdGPINCy0L3Rg9GC0YDQuCDRgNC10L3QtNC10YDQtdGA0LBcclxuICAgICAgICAgICAgbmV3UGxhY2VQb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHJlbmRlckxvYWRpbmcoZmFsc2UsIG5ld1BsYWNlUG9wdXAuYnV0dG9uKSk7XHJcbn0pO1xyXG5cclxuY29uc3QgbmV3QXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSgnLnBvcHVwX3R5cGVfY2hhbmdlLWF2YXRhcicsIChldnQpID0+IHtcclxuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgcmVuZGVyTG9hZGluZyh0cnVlLCBuZXdBdmF0YXJQb3B1cC5idXR0b24pO1xyXG4gICAgY29uc3QgW25ld0xpbmtdID0gbmV3QXZhdGFyUG9wdXAuZ2V0SW5wdXRWYWx1ZXMoKTtcclxuICAgIGFwaS51cGRhdGVBdmF0YXIobmV3TGluaylcclxuICAgICAgICAudGhlbihkYXRhID0+IHtcclxuICAgICAgICAgICAgdXNlclByb2ZpbGUuc2V0VXNlckluZm8oW2RhdGEubmFtZSwgZGF0YS5hYm91dCwgZGF0YS5hdmF0YXIsIGRhdGEuX2lkXSk7XHJcbiAgICAgICAgICAgIG5ld0F2YXRhclBvcHVwLmNsb3NlKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGVycikpXHJcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4gcmVuZGVyTG9hZGluZyhmYWxzZSwgbmV3QXZhdGFyUG9wdXAuYnV0dG9uKSk7XHJcbn0pXHJcblxyXG5cclxuLy8g0JfQsNCz0YDRg9C30LrQsCDQuNC90YTQvtGA0LzQsNGG0LjQuCDRgSDRgdC10YDQstC10YDQsFxyXG5cclxuZnVuY3Rpb24gbG9hZFNlcnZlckRhdGEoKSB7XHJcbiAgICBhcGkuZ2V0VXNlckluZm8oKVxyXG4gICAgICAgIC50aGVuKGRhdGEgPT4ge1xyXG4gICAgICAgICAgICB1c2VyUHJvZmlsZS5zZXRVc2VySW5mbyhbZGF0YS5uYW1lLCBkYXRhLmFib3V0LCBkYXRhLmF2YXRhciwgZGF0YS5faWRdKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgYXBpLmdldENhcmRzRnJvbVNlcnZlcigpXHJcbiAgICAgICAgICAgIC50aGVuKGRhdGEgPT4ge1xyXG4gICAgICAgICAgICAgICAgZGF0YS5yZXZlcnNlKCk7XHJcbiAgICAgICAgICAgICAgICBjYXJkU2VjdGlvbi5pdGVtcyA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICBjYXJkU2VjdGlvbi5yZW5kZXJlciA9IChpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjcmVhdGVDYXJkKGl0ZW0pKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGVycikpXHJcbn1cclxuXHJcbmxvYWRTZXJ2ZXJEYXRhKCk7XHJcblxyXG5cclxuXHJcbi8vINCj0YHRgtCw0L3QvtCy0LrQsCDRgdC70YPRiNCw0YLQtdC70LXQuVxyXG5waG90b1ZpZXdQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5wcm9maWxlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxubmV3UGxhY2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5jb25maXJtYXRpb25Qb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5uZXdBdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9wZW5Qcm9maWxlUG9wdXApO1xyXG5waG90b0FkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9wZW5OZXdQbGFjZVBvcHVwKTtcclxuYXZhdGFyRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9wZW5OZXdBdmF0YXJQb3B1cCk7XHJcblxyXG5cclxuLy8g0JTQvtCx0LDQstC70LXQvdC40LUg0LLQsNC70LjQtNCw0YbQuNC4XHJcbnBvcHVwQWRkUGxhY2VWYWxpZGF0aW9uLmVuYWJsZVZhbGlkYXRpb24oKTtcclxucG9wdXBFZGl0UHJvZmlsZVZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5wb3B1cE5ld0F2YXRhclZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuLy8g0J7RgtC60YDRi9GC0LjQtSDQv9C+0L/QsNC/0L7QslxyXG5mdW5jdGlvbiBvcGVuUHJvZmlsZVBvcHVwKCkge1xyXG4gICAgY29uc3QgcHJvZmlsZUluZm8gPSB1c2VyUHJvZmlsZS5nZXRVc2VySW5mbygpO1xyXG4gICAgdXNlck5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVJbmZvLm5hbWU7XHJcbiAgICB1c2VyRGVzY0lucHV0LnZhbHVlID0gcHJvZmlsZUluZm8uYWJvdXQ7XHJcbiAgICBwb3B1cEVkaXRQcm9maWxlVmFsaWRhdGlvbi5yZXNldFZhbGlkYXRpb25FcnJvcnMoKTtcclxuICAgIHBvcHVwRWRpdFByb2ZpbGVWYWxpZGF0aW9uLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICBwcm9maWxlUG9wdXAub3BlbigpO1xyXG4gICAgXHJcbn07XHJcblxyXG5mdW5jdGlvbiBvcGVuTmV3UGxhY2VQb3B1cCgpe1xyXG4gICAgcG9wdXBBZGRQbGFjZVZhbGlkYXRpb24ucmVzZXRWYWxpZGF0aW9uRXJyb3JzKCk7XHJcbiAgICBwb3B1cEFkZFBsYWNlVmFsaWRhdGlvbi50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgbmV3UGxhY2VQb3B1cC5vcGVuKCk7XHJcbn07XHJcblxyXG5jb25zdCBvcGVuUGhvdG9Qb3B1cCA9IChwaG90b05hbWUsIHBob3RvTGluaykgPT4ge1xyXG4gICAgcGhvdG9WaWV3UG9wdXAub3BlbihwaG90b05hbWUsIHBob3RvTGluayk7XHJcbn07XHJcblxyXG5jb25zdCBvcGVuQ29uZmlybWF0aW9uUG9wdXAgPSAoaGFuZGxlQ29uZmlybSkgPT4ge1xyXG4gICAgY29uZmlybWF0aW9uUG9wdXAuc2V0TmV3Q29uZmlybWVkQWN0aW9uKGhhbmRsZUNvbmZpcm0pO1xyXG4gICAgY29uZmlybWF0aW9uUG9wdXAub3BlbigpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBvcGVuTmV3QXZhdGFyUG9wdXAoKSB7XHJcbiAgICBwb3B1cE5ld0F2YXRhclZhbGlkYXRpb24ucmVzZXRWYWxpZGF0aW9uRXJyb3JzKCk7XHJcbiAgICBwb3B1cE5ld0F2YXRhclZhbGlkYXRpb24udG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgIG5ld0F2YXRhclBvcHVwLm9wZW4oKTtcclxufVxyXG5cclxuXHJcblxyXG4vLyDQlNC+0LHQsNCy0LvQtdC90LjQtSDQutCw0YDRgtC+0YfQtdC6XHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZEluZm8pIHtcclxuICAgIGNvbnN0IG5ld0NhcmQgPSBuZXcgQ2FyZChjYXJkSW5mbywgJyNwbGFjZS10ZW1wbGF0ZScsIG9wZW5QaG90b1BvcHVwLCBvcGVuQ29uZmlybWF0aW9uUG9wdXAsIGRlbGV0ZUNhcmQsIHVwZGF0ZUxpa2UsIHVzZXJQcm9maWxlLnVzZXJJZCk7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IG5ld0NhcmQuY3JlYXRlQ2FyZCgpO1xyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG59XHJcblxyXG4vLyDQo9C00LDQu9C10L3QuNC1INC60LDRgNGC0L7Rh9C10LpcclxuZnVuY3Rpb24gZGVsZXRlQ2FyZChDYXJkKSB7XHJcbiAgICBhcGkuZGVsZXRlQ2FyZChDYXJkLmNhcmRJZClcclxuICAgICAgICAudGhlbigoKSA9PiBDYXJkLmRlbGV0ZUNhcmRGcm9tRE9NKCkpXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG59XHJcblxyXG4vLyDQm9Cw0LnQutC4XHJcbmNvbnN0IGxpa2VDYXJkID0gKGNhcmRJZCkgPT4ge1xyXG4gICAgcmV0dXJuIGFwaS5saWtlQ2FyZChjYXJkSWQpO1xyXG59XHJcblxyXG5jb25zdCBkaXNsaWtlQ2FyZCA9IChjYXJkSWQpID0+IHtcclxuICAgIHJldHVybiBhcGkuZGlzbGlrZUNhcmQoY2FyZElkKTtcclxufVxyXG5cclxuY29uc3QgdXBkYXRlTGlrZSA9IChldnQsIENhcmQpID0+IHtcclxuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncGxhY2VfX2xpa2VfYWN0aXZlJykpIHtcclxuICAgICAgICBkaXNsaWtlQ2FyZChDYXJkLmNhcmRJZClcclxuICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5yZW1vdmUoJ3BsYWNlX19saWtlX2FjdGl2ZScpO1xyXG4gICAgICAgICAgICBldnQudGFyZ2V0Lm5leHRFbGVtZW50U2libGluZy50ZXh0Q29udGVudCA9IGRhdGEubGlrZXMubGVuZ3RoO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBsaWtlQ2FyZChDYXJkLmNhcmRJZClcclxuICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ3BsYWNlX19saWtlX2FjdGl2ZScpO1xyXG4gICAgICAgICAgICBldnQudGFyZ2V0Lm5leHRFbGVtZW50U2libGluZy50ZXh0Q29udGVudCA9IGRhdGEubGlrZXMubGVuZ3RoO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyDQl9Cw0LPRgNGD0LfQutCwXHJcbmZ1bmN0aW9uIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nLCBidXR0b25FbGVtZW50KSB7XHJcbiAgICBidXR0b25FbGVtZW50LnRleHRDb250ZW50ID0gaXNMb2FkaW5nID8gXCLQodC+0YXRgNCw0L3QtdC90LjQteKAplwiIDogXCLQodC+0YXRgNCw0L3QuNGC0YxcIjtcclxufVxyXG4iXSwibmFtZXMiOlsiQ2FyZCIsImNhcmQiLCJ0ZW1wbGF0ZVNlbGVjdG9yIiwib3BlblBob3RvUG9wdXBGdW5jdGlvbiIsIm9wZW5Db25maXJtYXRpb25Qb3B1cEZ1bmN0aW9uIiwiZGVsZXRlQ2FyZEZ1bmN0aW9uIiwidXBkYXRlTGlrZUZ1bmN0aW9uIiwidXNlcklkIiwidGhpcyIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsImNhcmRJZCIsIl9pZCIsIl9vd25lcklkIiwib3duZXIiLCJfdXNlcklkIiwiX3VzZXJzTGlrZWQiLCJsaWtlcyIsIl9udW1iZXJPZkxpa2VzIiwibGVuZ3RoIiwiX3RlbXBsYXRlU2VsZWN0b3IiLCJfb3BlbkltYWdlUG9wdXAiLCJfb3BlbkNvbmZpcm1hdGlvblBvcHVwIiwiX2RlbGV0ZUNhcmQiLCJfdXBkYXRlTGlrZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJldnQiLCJfbGlrZUJ1dHRvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJfdG9nZ2xlQWN0aXZlTGlrZSIsIl9kZWxldGVCdXR0b24iLCJfcGxhY2VQaWMiLCJfZWxlbWVudCIsIl9nZXRUZW1wbGF0ZSIsIl9wbGFjZSIsInJlbW92ZSIsIl9saWtlc0NvdW50ZXIiLCJzZXRBdHRyaWJ1dGUiLCJ0ZXh0Q29udGVudCIsInNvbWUiLCJ1c2VyIiwiY2xhc3NMaXN0IiwiYWRkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiZ2V0RWxlbWVudEJ5SWQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXAiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsImNsb3NlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwic3VibWl0RnVuY3Rpb24iLCJfc3VibWl0RnVuY3Rpb24iLCJfcG9wdXBGb3JtIiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJidXR0b24iLCJpbnB1dFZhbHVlcyIsImkiLCJ2YWx1ZSIsInJlc2V0IiwiU2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9jb250YWluZXIiLCJmb3JFYWNoIiwiaXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiRm9ybVZhbGlkYXRvciIsInNlbGVjdG9ycyIsImZvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX2ludmFsaWRJbnB1dENsYXNzIiwiaW52YWxpZElucHV0Q2xhc3MiLCJfYnV0dG9uU2VsZWN0b3IiLCJidXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9hY3RpdmVFcnJvckNsYXNzIiwiYWN0aXZlRXJyb3JDbGFzcyIsIl9mb3JtRWxlbWVudCIsIl9idXR0b25FbGVtZW50IiwiaW5wdXRMaXN0IiwiZWxlbSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGFzSW52YWxpZElucHV0IiwicmVtb3ZlQXR0cmlidXRlIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJpbnB1dCIsImhpZGVFcnJvck1lc3NhZ2UiLCJfc2hvd0Vycm9yTWVzc2FnZSIsInZhbGlkYXRpb25NZXNzYWdlIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwicHJldmVudERlZmF1bHQiLCJQb3B1cFdpdGhJbWFnZSIsIl9waG90b0VsZW1lbnQiLCJfdGl0bGVFbGVtZW50IiwicGhvdG9OYW1lIiwicGhvdG9MaW5rIiwiUG9wdXBXaXRoQ29uZmlybWF0aW9uIiwiaGFuZGxlQ29uZmlybUZ1bmN0aW9uIiwiaGFuZGxlQ29uZmlybSIsIl9leGVjdXRlQ29uZmlybWVkQWN0aW9uIiwiZXhlY3V0ZUNvbmZpcm1lZEFjdGlvbiIsImFjdGlvbiIsIlVzZXJJbmZvIiwidXNlck5hbWVTZWxlY3RvciIsInVzZXJEZXNjcmlwdGlvblNlbGVjdG9yIiwidXNlckF2YXRhclNlbGVjdG9yIiwiX3VzZXJOYW1lRWxlbWVudCIsIl91c2VyRGVzY3JpcHRpb25FbGVtZW50IiwiX3VzZXJBdmF0YXJFbGVtZW50IiwiYWJvdXQiLCJhdmF0YXIiLCJzdHlsZSIsInVzZXJOYW1lIiwidXNlckRlc2NyaXB0aW9uIiwidXNlckF2YXRhckxpbmsiLCJBcGkiLCJvcHRpb25zIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX3Rva2VuIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJfY29ob3J0IiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwiX2dldFJlc3BvbnNlRGF0YSIsIm5ld1VzZXJOYW1lIiwibmV3VXNlckRlc2NyaXB0aW9uIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJuZXdDYXJkIiwibmV3QXZhdGFyTGluayIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJmb3JtU2VsZWN0b3IiLCJ1c2VyTmFtZUlucHV0IiwidXNlckRlc2NJbnB1dCIsInByb2ZpbGVFZGl0QnV0dG9uIiwicGhvdG9BZGRCdXR0b24iLCJhdmF0YXJFZGl0QnV0dG9uIiwiYXBpIiwicG9wdXBBZGRQbGFjZVZhbGlkYXRpb24iLCJwb3B1cEVkaXRQcm9maWxlVmFsaWRhdGlvbiIsInBvcHVwTmV3QXZhdGFyVmFsaWRhdGlvbiIsInVzZXJQcm9maWxlIiwicGhvdG9WaWV3UG9wdXAiLCJjb25maXJtYXRpb25Qb3B1cCIsImNhcmRTZWN0aW9uIiwicHJvZmlsZVBvcHVwIiwicmVuZGVyTG9hZGluZyIsImdldElucHV0VmFsdWVzIiwiZWRpdFVzZXJJbmZvIiwiZGF0YSIsInNldFVzZXJJbmZvIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiZmluYWxseSIsIm5ld1BsYWNlUG9wdXAiLCJuZXdQbGFjZUlucHV0cyIsImFkZGVkQ2FyZCIsInBvc3ROZXdDYXJkIiwicmVuZGVySXRlbXMiLCJuZXdBdmF0YXJQb3B1cCIsIm5ld0xpbmsiLCJ1cGRhdGVBdmF0YXIiLCJnZXRVc2VySW5mbyIsImdldENhcmRzRnJvbVNlcnZlciIsInJldmVyc2UiLCJhZGRJdGVtIiwib3BlblBob3RvUG9wdXAiLCJvcGVuQ29uZmlybWF0aW9uUG9wdXAiLCJkZWxldGVDYXJkIiwidXBkYXRlTGlrZSIsImNyZWF0ZUNhcmQiLCJzZXRFdmVudExpc3RlbmVycyIsInByb2ZpbGVJbmZvIiwicmVzZXRWYWxpZGF0aW9uRXJyb3JzIiwib3BlbiIsImVuYWJsZVZhbGlkYXRpb24iLCJzZXROZXdDb25maXJtZWRBY3Rpb24iLCJkZWxldGVDYXJkRnJvbURPTSIsImRpc2xpa2VDYXJkIiwibmV4dEVsZW1lbnRTaWJsaW5nIiwibGlrZUNhcmQiLCJpc0xvYWRpbmciLCJidXR0b25FbGVtZW50Il0sInNvdXJjZVJvb3QiOiIifQ==