(()=>{"use strict";var t={};function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.p="";var n=function(){function t(e,n,r,o,i,c){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=e.name,this._link=e.link,this._cardId=e._id,this._ownerId=e.owner._id,this._usersLiked=e.likes,this._numberOfLikes=e.likes.length,this._templateSelector=n,this._openPopup=r,this._openConfirmationPopup=o,this._likeCard=i,this._dislikeCard=c}var n,r;return n=t,r=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelector).content.cloneNode(!0)}},{key:"_toggleActiveLike",value:function(t){t.target.classList.contains("place__like_active")?this._dislikeCard(this._cardId).then((function(e){t.target.classList.remove("place__like_active"),t.target.nextElementSibling.textContent=e.likes.length})).catch((function(t){return console.log(t)})):this._likeCard(this._cardId).then((function(e){t.target.classList.add("place__like_active"),t.target.nextElementSibling.textContent=e.likes.length})).catch((function(t){return console.log(t)}))}},{key:"_deleteCard",value:function(t){document.getElementById(t).innerHTML="",document.getElementById(t).remove()}},{key:"_setEventListeners",value:function(){var t=this;this._likeButton.addEventListener("click",(function(e){return t._toggleActiveLike(e)})),this._deleteButton.addEventListener("click",(function(){t._openConfirmationPopup((function(){return t._deleteCard(t._cardId)}))})),this._placepic.addEventListener("click",(function(){return t._openPopup(t._name,t._link)}))}},{key:"createCard",value:function(t){var e=this;return this._element=this._getTemplate(),this._place=this._element.querySelector(".place"),this._deleteButton=this._place.querySelector(".place__delete-button"),t!=this._ownerId&&this._deleteButton.remove(),this._placepic=this._element.querySelector(".place__pic"),this._likesCounter=this._element.querySelector(".place__number-of-likes"),this._placepic.setAttribute("src",this._link),this._placepic.setAttribute("alt",this._name),this._element.querySelector(".place__name").textContent=this._name,this._likeButton=this._place.querySelector(".place__like"),this._likesCounter.textContent=this._numberOfLikes,this._usersLiked.forEach((function(n){n._id===t&&e._likeButton.classList.add("place__like_active")})),this._place.setAttribute("id",this._cardId),this._setEventListeners(),this._element}}],r&&e(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._invalidInputClass=e.invalidInputClass,this._buttonSelector=e.buttonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._activeErrorClass=e.activeErrorClass,this._formElement=n,this._buttonElement=n.querySelector(this._buttonSelector)}var e,n;return e=t,(n=[{key:"_getInputList",value:function(){return Array.from(this._formElement.querySelectorAll(this._inputSelector))}},{key:"_hasInvalidInput",value:function(t){return t.some((function(t){return!t.validity.valid}))}},{key:"toggleButtonState",value:function(){this._hasInvalidInput(this._getInputList())?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.removeAttribute("disabled",!0))}},{key:"_showErrorMessage",value:function(t,e){var n=this._formElement.querySelector(".popup__".concat(t.id,"-error"));n.textContent=e,n.classList.add(this._activeErrorClass),t.classList.add(this._invalidInputClass)}},{key:"hideErrorMessage",value:function(t){var e=this._formElement.querySelector(".popup__".concat(t.id,"-error"));e.textContent="",e.classList.remove(this._activeErrorClass),t.classList.remove(this._invalidInputClass)}},{key:"_checkInputValidity",value:function(t){t.validity.valid?this.hideErrorMessage(t):this._showErrorMessage(t,t.validationMessage)}},{key:"_setEventListeners",value:function(){var t=this;this._inputList=this._getInputList(),this.toggleButtonState(),this._inputList.forEach((function(e){e.addEventListener("input",(function(){t._checkInputValidity(e),t.toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._formElement.addEventListener("submit",(function(t){t.preventDefault()})),this._setEventListeners()}}])&&r(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this),this.button=this._popup.querySelector(".popup__save-btn")}var e,n;return e=t,(n=[{key:"open",value:function(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"_handleEscClose",value:function(t){"Escape"===t.key&&this.close()}},{key:"setEventListeners",value:function(){var t=this;this._popup.addEventListener("click",(function(e){(e.target.classList.contains("popup")||e.target.classList.contains("popup__close-btn"))&&t.close()}))}}])&&i(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=l(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},s.apply(this,arguments)}function l(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}function p(t,e){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},p(t,e)}function f(t,e){if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e)}(c,t);var e,n,r,o,i=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=h(r);if(o){var n=h(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return f(this,t)});function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(e=i.call(this,t))._photoElement=e._popup.querySelector(".popup__photo"),e._titleElement=e._popup.querySelector(".popup__photo-title"),e}return e=c,(n=[{key:"open",value:function(t,e){this._photoElement.setAttribute("src",e),this._photoElement.setAttribute("alt",t),this._titleElement.textContent=t,s(h(c.prototype),"open",this).call(this)}}])&&u(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),c}(c);function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function _(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function v(){return v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=m(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},v.apply(this,arguments)}function m(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=k(t)););return t}function b(t,e){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},b(t,e)}function g(t,e){if(e&&("object"===d(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function k(t){return k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},k(t)}var w=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b(t,e)}(c,t);var e,n,r,o,i=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=k(r);if(o){var n=k(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return g(this,t)});function c(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(n=i.call(this,t))._submitFunction=e,n._popupForm=n._popup.querySelector(".popup__form"),n._inputList=Array.from(n._popup.querySelectorAll(".popup__input")),n}return e=c,(n=[{key:"getInputValues",value:function(){for(var t=[],e=0;e<this._inputList.length;e++)t[e]=this._inputList[e].value;return t}},{key:"setEventListeners",value:function(){var t=this;v(k(c.prototype),"setEventListeners",this).call(this),this._popupForm.addEventListener("submit",(function(e){return t._submitFunction(e)}))}},{key:"close",value:function(){v(k(c.prototype),"close",this).call(this),this._popupForm.reset()}}])&&_(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),c}(c);function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}function S(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function j(){return j="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=O(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},j.apply(this,arguments)}function O(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=I(t)););return t}function C(t,e){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},C(t,e)}function P(t,e){if(e&&("object"===E(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return L(t)}function L(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function I(t){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},I(t)}var A=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&C(t,e)}(c,t);var e,n,r,o,i=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=I(r);if(o){var n=I(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return P(this,t)});function c(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(n=i.call(this,t)).confirmedAction=e,n._executeConfirmedAction=n.executeConfirmedAction.bind(L(n)),n}return e=c,(n=[{key:"setNewConfirmedAction",value:function(t){this.confirmedAction=t}},{key:"executeConfirmedAction",value:function(){this.confirmedAction(),this.close()}},{key:"setEventListeners",value:function(){j(I(c.prototype),"setEventListeners",this).call(this),this.button.addEventListener("click",this._executeConfirmedAction)}}])&&S(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),c}(c);function q(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function T(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var x=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._userNameElement=document.querySelector(e),this._userDescriptionElement=document.querySelector(n),this._userAvatarElement=document.querySelector(r)}var e,n;return e=t,(n=[{key:"getUserInfo",value:function(){return{name:this._userNameElement.textContent,about:this._userDescriptionElement.textContent}}},{key:"setUserInfo",value:function(t){var e,n,r=(n=3,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],c=!0,a=!1;try{for(n=n.call(t);!(c=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);c=!0);}catch(t){a=!0,o=t}finally{try{c||null==n.return||n.return()}finally{if(a)throw o}}return i}}(e,n)||function(t,e){if(t){if("string"==typeof t)return q(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?q(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1],c=r[2];this._userNameElement.textContent=o,this._userDescriptionElement.textContent=i,this._userAvatarElement.style["background-image"]="url(".concat(c,")")}}])&&T(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function R(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var B=function(){function t(e,n){var r=e.items,o=e.renderer;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.items=r,this._renderer=o,this._container=document.querySelector(n)}var e,n;return e=t,(n=[{key:"renderItems",value:function(){var t=this;this.items.forEach((function(e){t._renderer(e)}))}},{key:"addItem",value:function(t){this._container.prepend(t)}}])&&R(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function U(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function D(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var M=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._baseUrl=e.baseUrl,this._token=e.headers.authorization,this._cohort="cohort-50"}var e,n;return e=t,(n=[{key:"getUserInfo",value:function(){return fetch("".concat(this._baseUrl,"/").concat(this._cohort,"/users/me"),{headers:{authorization:this._token,"Content-Type":"application/json"}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"getCardsFromServer",value:function(){return fetch("https://mesto.nomoreparties.co/v1/".concat(this._cohort,"/cards"),{headers:{authorization:this._token,"Content-Type":"application/json"}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"editUserInfo",value:function(t){var e,n,r=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],c=!0,a=!1;try{for(n=n.call(t);!(c=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);c=!0);}catch(t){a=!0,o=t}finally{try{c||null==n.return||n.return()}finally{if(a)throw o}}return i}}(e,n)||function(t,e){if(t){if("string"==typeof t)return U(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?U(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];return fetch("https://mesto.nomoreparties.co/v1/".concat(this._cohort,"/users/me"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:o,about:i})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"postNewCard",value:function(t){return fetch("https://mesto.nomoreparties.co/v1/".concat(this._cohort,"/cards"),{method:"POST",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:t.name,link:t.link})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"likeCard",value:function(t){return fetch("https://mesto.nomoreparties.co/v1/".concat(this._cohort,"/cards/").concat(t,"/likes"),{method:"PUT",headers:{authorization:this._token,"Content-Type":"application/json"}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"dislikeCard",value:function(t){return fetch("https://mesto.nomoreparties.co/v1/".concat(this._cohort,"/cards/").concat(t,"/likes"),{method:"DELETE",headers:{authorization:this._token,"Content-Type":"application/json"}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"updateAvatar",value:function(t){return fetch("https://mesto.nomoreparties.co/v1/".concat(this._cohort,"/users/me/avatar"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({avatar:t})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}}])&&D(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.p,t.p,t.p,t.p,t.p,t.p;var N={formSelector:".popup__form",inputSelector:".popup__input",invalidInputClass:"popup__input_invalid",buttonSelector:".popup__save-btn",inactiveButtonClass:"popup__save-btn_inactive",activeErrorClass:"popup__input-error_active"},V=document.querySelector(".popup__input_type_user-name"),z=document.querySelector(".popup__input_type_user-desc"),F=document.querySelector(".popup__input_type_place-name"),H=document.querySelector(".popup__input_type_place-link"),J=document.querySelector(".popup__input_type_avatar-link"),$=document.querySelector(".profile__edit-button"),G=document.querySelector(".profile__add-button"),K=document.querySelector(".avatar__edit-pic");function Q(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var W,X,Y=new M({baseUrl:"https://nomoreparties.co/v1/",headers:{authorization:"85ece6ec-ad42-4595-ab64-f4ab4791389f","Content-Type":"application/json"}}),Z=new o(N,document.querySelector(".popup_type_add-place").querySelector(N.formSelector)),tt=new o(N,document.querySelector(".popup_type_edit-profile").querySelector(N.formSelector)),et=new o(N,document.querySelector(".popup_type_change-avatar").querySelector(N.formSelector)),nt=new x(".profile__user-name",".profile__user-description",".avatar"),rt=new y(".popup_type_photo-view"),ot=new w(".popup_type_edit-profile",(function(t){t.preventDefault(),ft(!0,ot.button);var e=ot.getInputValues();Y.editUserInfo(e).then((function(t){nt.setUserInfo([t.name,t.about,t.avatar]),ft(!1,ot.button),ot.close()})).catch((function(t){return console.log(t)}))})),it=new w(".popup_type_add-place",(function(t){t.preventDefault(),ft(!0,it.button);var e=it.getInputValues(),n={name:e[0],link:e[1]};Y.postNewCard(n).then((function(t){W.items=[t],W.renderItems(),ft(!1,it.button),it.close()})).catch((function(t){return console.log(t)}))})),ct=new w(".popup_type_change-avatar",(function(t){t.preventDefault(),ft(!0,ct.button);var e,n,r=(e=ct.getInputValues(),n=1,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],c=!0,a=!1;try{for(n=n.call(t);!(c=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);c=!0);}catch(t){a=!0,o=t}finally{try{c||null==n.return||n.return()}finally{if(a)throw o}}return i}}(e,n)||function(t,e){if(t){if("string"==typeof t)return Q(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Q(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];Y.updateAvatar(r).then((function(t){nt.setUserInfo([t.name,t.about,t.avatar]),ft(!1,ct.button),ct.close()})).catch((function(t){return console.log(t)}))})),at=new A(".popup_type_confirmation",(function(){}));Y.getUserInfo().then((function(t){nt.setUserInfo([t.name,t.about,t.avatar]),X=t._id})).then((function(){Y.getCardsFromServer().then((function(t){(W=new B({items:t,renderer:function(t){W.addItem(new n(t,"#place-template",ut,st,lt,pt).createCard(X))}},".places")).renderItems()})).catch((function(t){return console.log(t)}))})).catch((function(t){return console.log(t)})),rt.setEventListeners(),ot.setEventListeners(),it.setEventListeners(),at.setEventListeners(),ct.setEventListeners(),$.addEventListener("click",(function(){var t=nt.getUserInfo();V.value=t.name,z.value=t.about,tt.hideErrorMessage(V),tt.hideErrorMessage(z),tt.toggleButtonState(),ot.open()})),G.addEventListener("click",(function(){Z.hideErrorMessage(F),Z.hideErrorMessage(H),Z.toggleButtonState(),it.open()})),K.addEventListener("click",(function(){et.hideErrorMessage(J),et.toggleButtonState(),ct.open()})),Z.enableValidation(),tt.enableValidation(),et.enableValidation();var ut=function(t,e){rt.open(t,e)},st=function(t){at.confirmedAction=t,at.open()},lt=function(t){return Y.likeCard(t)},pt=function(t){return Y.dislikeCard(t)};function ft(t,e){e.textContent=t?"Сохранение…":"Сохранить"}})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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a0JTLG9CQUNsQlosR0FBZVksb0JBQ2ZoQyxFQUFrQmxJLGlCQUFpQixTQWFuQyxXQUNJLElBQUltSyxFQUFjekIsR0FBWWdCLGNBQzlCN0IsRUFBY3JELE1BQVEyRixFQUFZek0sS0FDbENvSyxFQUFjdEQsTUFBUTJGLEVBQVk3RSxNQUNsQ2tELEdBQTJCM0YsaUJBQWlCZ0YsR0FDNUNXLEdBQTJCM0YsaUJBQWlCaUYsR0FDNUNVLEdBQTJCdkYsb0JBQzNCMkYsR0FBYXdCLE1BRWhCLElBckJEakMsRUFBZW5JLGlCQUFpQixTQXVCaEMsV0FDSXVJLEVBQXdCMUYsaUJBQWlCa0YsR0FDekNRLEVBQXdCMUYsaUJBQWlCbUYsR0FDekNPLEVBQXdCdEYsb0JBQ3hCZ0csR0FBY21CLE1BQ2pCLElBM0JEaEMsRUFBaUJwSSxpQkFBaUIsU0FzQ2xDLFdBQ0l5SSxHQUF5QjVGLGlCQUFpQm9GLEdBQzFDUSxHQUF5QnhGLG9CQUN6QnFHLEdBQWVjLE1BQ2xCLElBckNBN0IsRUFBd0I4QixtQkFDeEI3QixHQUEyQjZCLG1CQUMzQjVCLEdBQXlCNEIsbUJBc0IxQixJQUFNUixHQUFpQixTQUFDN0YsRUFBV0MsR0FDL0IwRSxHQUFleUIsS0FBS3BHLEVBQVdDLEVBQ2xDLEVBRUs2RixHQUF3QixTQUFDbkYsR0FDM0I4RSxHQUFrQjlFLGdCQUFrQkEsRUFDcEM4RSxHQUFrQlcsTUFDckIsRUFrQktMLEdBQVcsU0FBQ3JDLEdBQ2QsT0FBT1ksRUFBSXlCLFNBQVNyQyxFQUN2QixFQUVLc0MsR0FBYyxTQUFDdEMsR0FDakIsT0FBT1ksRUFBSTBCLFlBQVl0QyxFQUMxQixFQUdELFNBQVNtQixHQUFjeUIsRUFBV0MsR0FDOUJBLEVBQWNqTCxZQUFjZ0wsRUFBWSxjQUFnQixXQUMzRCxDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovLy93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9jYXJkLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvcG9wdXAuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvcG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvcG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9wb3B1cFdpdGhDb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvdXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvc2VjdGlvbi5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9hcGkuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcGFnZXMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiZXhwb3J0IGNsYXNzIENhcmQge1xyXG4gICAgY29uc3RydWN0b3IoY2FyZCwgdGVtcGxhdGVTZWxlY3Rvciwgb3BlblBob3RvUG9wdXBGdW5jdGlvbiwgb3BlbkNvbmZpcm1hdGlvblBvcHVwRnVuY3Rpb24sIGxpa2VDYXJkRnVuY3Rpb24sIGRpc2xpa2VDYXJkRnVuY3Rpb24pIHtcclxuICAgICAgICB0aGlzLl9uYW1lID0gY2FyZC5uYW1lO1xyXG4gICAgICAgIHRoaXMuX2xpbmsgPSBjYXJkLmxpbms7XHJcbiAgICAgICAgdGhpcy5fY2FyZElkID0gY2FyZC5faWQ7XHJcbiAgICAgICAgdGhpcy5fb3duZXJJZCA9IGNhcmQub3duZXIuX2lkO1xyXG4gICAgICAgIHRoaXMuX3VzZXJzTGlrZWQgPSBjYXJkLmxpa2VzO1xyXG4gICAgICAgIHRoaXMuX251bWJlck9mTGlrZXMgPSBjYXJkLmxpa2VzLmxlbmd0aDtcclxuICAgICAgICB0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yID0gdGVtcGxhdGVTZWxlY3RvcjtcclxuICAgICAgICB0aGlzLl9vcGVuUG9wdXAgPSBvcGVuUGhvdG9Qb3B1cEZ1bmN0aW9uO1xyXG4gICAgICAgIHRoaXMuX29wZW5Db25maXJtYXRpb25Qb3B1cCA9IG9wZW5Db25maXJtYXRpb25Qb3B1cEZ1bmN0aW9uO1xyXG4gICAgICAgIHRoaXMuX2xpa2VDYXJkID0gbGlrZUNhcmRGdW5jdGlvbjtcclxuICAgICAgICB0aGlzLl9kaXNsaWtlQ2FyZCA9IGRpc2xpa2VDYXJkRnVuY3Rpb247XHJcbiAgICB9XHJcblxyXG4gICAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yKS5jb250ZW50LmNsb25lTm9kZSh0cnVlKTtcclxuICAgICAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgX3RvZ2dsZUFjdGl2ZUxpa2UoZXZ0KSB7XHJcbiAgICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwbGFjZV9fbGlrZV9hY3RpdmUnKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9kaXNsaWtlQ2FyZCh0aGlzLl9jYXJkSWQpXHJcbiAgICAgICAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5yZW1vdmUoJ3BsYWNlX19saWtlX2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgZXZ0LnRhcmdldC5uZXh0RWxlbWVudFNpYmxpbmcudGV4dENvbnRlbnQgPSBkYXRhLmxpa2VzLmxlbmd0aDtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xpa2VDYXJkKHRoaXMuX2NhcmRJZClcclxuICAgICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmFkZCgncGxhY2VfX2xpa2VfYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICBldnQudGFyZ2V0Lm5leHRFbGVtZW50U2libGluZy50ZXh0Q29udGVudCA9IGRhdGEubGlrZXMubGVuZ3RoO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9kZWxldGVDYXJkKGlkKSB7XHJcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpLmlubmVySFRNTCA9ICcnO1xyXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKS5yZW1vdmUoKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZ0KSA9PiB0aGlzLl90b2dnbGVBY3RpdmVMaWtlKGV2dCkpO1xyXG4gICAgICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgYWN0aW9uID0gKCkgPT4gdGhpcy5fZGVsZXRlQ2FyZCh0aGlzLl9jYXJkSWQpO1xyXG4gICAgICAgICAgICB0aGlzLl9vcGVuQ29uZmlybWF0aW9uUG9wdXAoYWN0aW9uKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLl9wbGFjZXBpYy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuX29wZW5Qb3B1cCh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKSlcclxuICAgIH1cclxuXHJcbiAgICBjcmVhdGVDYXJkKHVzZXJJZCkge1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgICAgIHRoaXMuX3BsYWNlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucGxhY2UnKTtcclxuICAgICAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9wbGFjZS5xdWVyeVNlbGVjdG9yKCcucGxhY2VfX2RlbGV0ZS1idXR0b24nKTtcclxuICAgICAgICBpZiAodXNlcklkICE9IHRoaXMuX293bmVySWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uLnJlbW92ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9wbGFjZXBpYyA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLnBsYWNlX19waWMnKTtcclxuICAgICAgICB0aGlzLl9saWtlc0NvdW50ZXIgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZV9fbnVtYmVyLW9mLWxpa2VzJyk7XHJcbiAgICAgICAgdGhpcy5fcGxhY2VwaWMuc2V0QXR0cmlidXRlKCdzcmMnLCB0aGlzLl9saW5rKTtcclxuICAgICAgICB0aGlzLl9wbGFjZXBpYy5zZXRBdHRyaWJ1dGUoJ2FsdCcsIHRoaXMuX25hbWUpO1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLnBsYWNlX19uYW1lJykudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9wbGFjZS5xdWVyeVNlbGVjdG9yKCcucGxhY2VfX2xpa2UnKTtcclxuICAgICAgICB0aGlzLl9saWtlc0NvdW50ZXIudGV4dENvbnRlbnQgPSB0aGlzLl9udW1iZXJPZkxpa2VzO1xyXG4gICAgICAgIHRoaXMuX3VzZXJzTGlrZWQuZm9yRWFjaCh1c2VyID0+IHtcclxuICAgICAgICAgICAgaWYgKHVzZXIuX2lkID09PSB1c2VySWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZCgncGxhY2VfX2xpa2VfYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgIHRoaXMuX3BsYWNlLnNldEF0dHJpYnV0ZSgnaWQnLCB0aGlzLl9jYXJkSWQpO1xyXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgY2xhc3MgZm9ybVZhbGlkYXRvciB7XHJcbiAgICBjb25zdHJ1Y3RvcihzZWxlY3RvcnMsIGZvcm1FbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5fZm9ybVNlbGVjdG9yID0gc2VsZWN0b3JzLmZvcm1TZWxlY3RvcjtcclxuICAgICAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2VsZWN0b3JzLmlucHV0U2VsZWN0b3I7XHJcbiAgICAgICAgdGhpcy5faW52YWxpZElucHV0Q2xhc3MgPSBzZWxlY3RvcnMuaW52YWxpZElucHV0Q2xhc3M7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uU2VsZWN0b3IgPSBzZWxlY3RvcnMuYnV0dG9uU2VsZWN0b3I7XHJcbiAgICAgICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNlbGVjdG9ycy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgICAgIHRoaXMuX2FjdGl2ZUVycm9yQ2xhc3MgPSBzZWxlY3RvcnMuYWN0aXZlRXJyb3JDbGFzcztcclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2J1dHRvblNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0SW5wdXRMaXN0KCkge1xyXG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcikpO1xyXG4gICAgfVxyXG5cclxuICAgIF9oYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSB7XHJcbiAgICAgICAgcmV0dXJuIGlucHV0TGlzdC5zb21lKGVsZW0gPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gIWVsZW0udmFsaWRpdHkudmFsaWQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICAgICAgaWYodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2dldElucHV0TGlzdCgpKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsIHRydWUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgdHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9zaG93RXJyb3JNZXNzYWdlKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XHJcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLnBvcHVwX18ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fYWN0aXZlRXJyb3JDbGFzcyk7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW52YWxpZElucHV0Q2xhc3MpO1xyXG4gICAgfVxyXG5cclxuICAgIGhpZGVFcnJvck1lc3NhZ2UoaW5wdXRFbGVtZW50KSB7XHJcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLnBvcHVwX18ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcclxuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9hY3RpdmVFcnJvckNsYXNzKTtcclxuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnZhbGlkSW5wdXRDbGFzcyk7XHJcbiAgICB9XHJcblxyXG4gICAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgICAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9zaG93RXJyb3JNZXNzYWdlKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmhpZGVFcnJvck1lc3NhZ2UoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX2dldElucHV0TGlzdCgpO1xyXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaChlbGVtID0+IHtcclxuICAgICAgICAgICAgZWxlbS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShlbGVtKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZXZ0ID0+IHtcclxuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGNsYXNzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuYnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19zYXZlLWJ0bicpO1xyXG4gICAgfTtcclxuXHJcbiAgICBvcGVuKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX29wZW5lZCcpO1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB9O1xyXG5cclxuICAgIGNsb3NlKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX29wZW5lZCcpO1xyXG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XHJcbiAgICAgICAgaWYgKGV2dC5rZXkgPT09ICdFc2NhcGUnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2dCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cCcpKSB8fCAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwX19jbG9zZS1idG4nKSkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gKTtcclxuICAgIH07XHJcbn0iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL3BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fcGhvdG9FbGVtZW50ID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19waG90bycpO1xyXG4gICAgICAgIHRoaXMuX3RpdGxlRWxlbWVudCA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fcGhvdG8tdGl0bGUnKTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuKHBob3RvTmFtZSwgcGhvdG9MaW5rKSB7XHJcbiAgICAgICAgdGhpcy5fcGhvdG9FbGVtZW50LnNldEF0dHJpYnV0ZSgnc3JjJywgcGhvdG9MaW5rKTtcclxuICAgICAgICB0aGlzLl9waG90b0VsZW1lbnQuc2V0QXR0cmlidXRlKCdhbHQnLCBwaG90b05hbWUpO1xyXG4gICAgICAgIHRoaXMuX3RpdGxlRWxlbWVudC50ZXh0Q29udGVudCA9IHBob3RvTmFtZTtcclxuICAgICAgICBzdXBlci5vcGVuKCk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL3BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIHN1Ym1pdEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0RnVuY3Rpb24gPSBzdWJtaXRGdW5jdGlvbjtcclxuICAgICAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKTtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3JBbGwoJy5wb3B1cF9faW5wdXQnKSk7XHJcbiAgICB9O1xyXG5cclxuICAgIGdldElucHV0VmFsdWVzKCkge1xyXG4gICAgICAgIGNvbnN0IGlucHV0VmFsdWVzID0gW107XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLl9pbnB1dExpc3QubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaW5wdXRWYWx1ZXNbaV0gPSB0aGlzLl9pbnB1dExpc3RbaV0udmFsdWU7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XHJcbiAgICB9O1xyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHRoaXMuX3N1Ym1pdEZ1bmN0aW9uKGV2dCkpO1xyXG4gICAgfTtcclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xyXG4gICAgfTtcclxufSIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vcG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBjb25maXJtZWRBY3Rpb24pIHtcclxuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLmNvbmZpcm1lZEFjdGlvbiA9IGNvbmZpcm1lZEFjdGlvbjtcclxuICAgICAgICB0aGlzLl9leGVjdXRlQ29uZmlybWVkQWN0aW9uID0gdGhpcy5leGVjdXRlQ29uZmlybWVkQWN0aW9uLmJpbmQodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0TmV3Q29uZmlybWVkQWN0aW9uKGFjdGlvbikge1xyXG4gICAgICAgIHRoaXMuY29uZmlybWVkQWN0aW9uID0gYWN0aW9uO1xyXG4gICAgfVxyXG5cclxuICAgIGV4ZWN1dGVDb25maXJtZWRBY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5jb25maXJtZWRBY3Rpb24oKTtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgICAgICB0aGlzLmJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX2V4ZWN1dGVDb25maXJtZWRBY3Rpb24pO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGNsYXNzIFVzZXJJbmZvIHtcclxuICAgIGNvbnN0cnVjdG9yKHVzZXJOYW1lU2VsZWN0b3IsIHVzZXJEZXNjcmlwdGlvblNlbGVjdG9yLCB1c2VyQXZhdGFyU2VsZWN0b3IpIHtcclxuICAgICAgICB0aGlzLl91c2VyTmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJOYW1lU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX3VzZXJEZXNjcmlwdGlvbkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJEZXNjcmlwdGlvblNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl91c2VyQXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckF2YXRhclNlbGVjdG9yKTtcclxuICAgIH07XHJcblxyXG4gICAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICAgICAgY29uc3QgdXNlckluZm8gPSB7XHJcbiAgICAgICAgICAgIG5hbWU6IHRoaXMuX3VzZXJOYW1lRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgICAgICAgICAgYWJvdXQ6IHRoaXMuX3VzZXJEZXNjcmlwdGlvbkVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHVzZXJJbmZvO1xyXG4gICAgfTtcclxuXHJcbiAgICBzZXRVc2VySW5mbyhbdXNlck5hbWUsIHVzZXJEZXNjcmlwdGlvbiwgdXNlckF2YXRhckxpbmtdKSB7XHJcbiAgICAgICAgdGhpcy5fdXNlck5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gdXNlck5hbWU7XHJcbiAgICAgICAgdGhpcy5fdXNlckRlc2NyaXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCA9IHVzZXJEZXNjcmlwdGlvbjtcclxuICAgICAgICB0aGlzLl91c2VyQXZhdGFyRWxlbWVudC5zdHlsZVtgYmFja2dyb3VuZC1pbWFnZWBdID0gYHVybCgke3VzZXJBdmF0YXJMaW5rfSlgO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGNsYXNzIFNlY3Rpb24ge1xyXG4gICAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgICAgICB0aGlzLml0ZW1zID0gaXRlbXM7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICAgIH07XHJcblxyXG4gICAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICAgICAgdGhpcy5pdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgY2xhc3MgQXBpIHtcclxuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgICAgICB0aGlzLl9iYXNlVXJsID0gb3B0aW9ucy5iYXNlVXJsO1xyXG4gICAgICAgIHRoaXMuX3Rva2VuID0gb3B0aW9ucy5oZWFkZXJzLmF1dGhvcml6YXRpb247XHJcbiAgICAgICAgdGhpcy5fY29ob3J0ID0gXCJjb2hvcnQtNTBcIjtcclxuICAgIH1cclxuXHJcbiAgICBnZXRVc2VySW5mbygpIHtcclxuICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS8ke3RoaXMuX2NvaG9ydH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgICAgICdhdXRob3JpemF0aW9uJzogdGhpcy5fdG9rZW4sXHJcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBnZXRDYXJkc0Zyb21TZXJ2ZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGBodHRwczovL21lc3RvLm5vbW9yZXBhcnRpZXMuY28vdjEvJHt0aGlzLl9jb2hvcnR9L2NhcmRzYCwge1xyXG4gICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAnYXV0aG9yaXphdGlvbic6IHRoaXMuX3Rva2VuLFxyXG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGVkaXRVc2VySW5mbyhbbmV3VXNlck5hbWUsIG5ld1VzZXJEZXNjcmlwdGlvbl0pIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYGh0dHBzOi8vbWVzdG8ubm9tb3JlcGFydGllcy5jby92MS8ke3RoaXMuX2NvaG9ydH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ1BBVENIJyxcclxuICAgICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgJ2F1dGhvcml6YXRpb24nOiB0aGlzLl90b2tlbixcclxuICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgbmFtZTogbmV3VXNlck5hbWUsXHJcbiAgICAgICAgICAgICAgICBhYm91dDogbmV3VXNlckRlc2NyaXB0aW9uXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgcG9zdE5ld0NhcmQobmV3Q2FyZCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgaHR0cHM6Ly9tZXN0by5ub21vcmVwYXJ0aWVzLmNvL3YxLyR7dGhpcy5fY29ob3J0fS9jYXJkc2AsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgICAgICdhdXRob3JpemF0aW9uJzogdGhpcy5fdG9rZW4sXHJcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IG5ld0NhcmQubmFtZSxcclxuICAgICAgICAgICAgICAgIGxpbms6IG5ld0NhcmQubGlua1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgbGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGBodHRwczovL21lc3RvLm5vbW9yZXBhcnRpZXMuY28vdjEvJHt0aGlzLl9jb2hvcnR9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiAnUFVUJyxcclxuICAgICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgJ2F1dGhvcml6YXRpb24nOiB0aGlzLl90b2tlbixcclxuICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBkaXNsaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYGh0dHBzOi8vbWVzdG8ubm9tb3JlcGFydGllcy5jby92MS8ke3RoaXMuX2NvaG9ydH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAnYXV0aG9yaXphdGlvbic6IHRoaXMuX3Rva2VuLFxyXG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZUF2YXRhcihuZXdBdmF0YXJMaW5rKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGBodHRwczovL21lc3RvLm5vbW9yZXBhcnRpZXMuY28vdjEvJHt0aGlzLl9jb2hvcnR9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAnYXV0aG9yaXphdGlvbic6IHRoaXMuX3Rva2VuLFxyXG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBhdmF0YXI6IG5ld0F2YXRhckxpbmtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgbG9uZG9uSW1hZ2UgZnJvbSBcIi4uL2ltYWdlcy9wbGFjZXMvbG9uZG9uLmpwZ1wiO1xyXG5pbXBvcnQgcGFyaXNJbWFnZSBmcm9tIFwiLi4vaW1hZ2VzL3BsYWNlcy9wYXJpcy5qcGdcIjtcclxuaW1wb3J0IHByYWd1ZUltYWdlIGZyb20gXCIuLi9pbWFnZXMvcGxhY2VzL3ByYWd1ZS5qcGdcIjtcclxuaW1wb3J0IHN0cGV0ZXJzYnVyZ0ltYWdlIGZyb20gXCIuLi9pbWFnZXMvcGxhY2VzL3N0LXBldGVyc2J1dGcuanBnXCI7XHJcbmltcG9ydCB0b2tpb0ltYWdlIGZyb20gXCIuLi9pbWFnZXMvcGxhY2VzL3Rva2lvLmpwZ1wiO1xyXG5pbXBvcnQgdmFuY291dmVySW1hZ2UgZnJvbSBcIi4uL2ltYWdlcy9wbGFjZXMvdmFuY291dmVyLmpwZ1wiO1xyXG5cclxuZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICAgIHtcclxuICAgICAgICBuYW1lOiAn0JvQvtC90LTQvtC9JyxcclxuICAgICAgICBsaW5rOiBsb25kb25JbWFnZVxyXG4gICAgfSxcclxuXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogJ9Cf0LDRgNC40LYnLFxyXG4gICAgICAgIGxpbms6IHBhcmlzSW1hZ2VcclxuICAgIH0sXHJcblxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6ICfQn9GA0LDQs9CwJyxcclxuICAgICAgICBsaW5rOiBwcmFndWVJbWFnZVxyXG4gICAgfSxcclxuXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogJ9Ch0LDQvdC60YIt0J/QtdGC0LXRgNCx0YPRgNCzJyxcclxuICAgICAgICBsaW5rOiBzdHBldGVyc2J1cmdJbWFnZVxyXG4gICAgfSxcclxuXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogJ9Ci0L7QutC40L4nLFxyXG4gICAgICAgIGxpbms6IHRva2lvSW1hZ2VcclxuICAgIH0sXHJcblxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6ICfQktCw0L3QutGD0LLQtdGAJyxcclxuICAgICAgICBsaW5rOiB2YW5jb3V2ZXJJbWFnZVxyXG4gICAgfSxcclxuXTtcclxuXHJcbmV4cG9ydCBjb25zdCBzZWxlY3RvcnMgPSB7XHJcbiAgICBmb3JtU2VsZWN0b3I6ICcucG9wdXBfX2Zvcm0nLFxyXG4gICAgaW5wdXRTZWxlY3RvcjogJy5wb3B1cF9faW5wdXQnLFxyXG4gICAgaW52YWxpZElucHV0Q2xhc3M6ICdwb3B1cF9faW5wdXRfaW52YWxpZCcsXHJcbiAgICBidXR0b25TZWxlY3RvcjogJy5wb3B1cF9fc2F2ZS1idG4nLFxyXG4gICAgaW5hY3RpdmVCdXR0b25DbGFzczogICdwb3B1cF9fc2F2ZS1idG5faW5hY3RpdmUnLFxyXG4gICAgYWN0aXZlRXJyb3JDbGFzczogJ3BvcHVwX19pbnB1dC1lcnJvcl9hY3RpdmUnXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgdXNlck5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV91c2VyLW5hbWUnKTtcclxuZXhwb3J0IGNvbnN0IHVzZXJEZXNjSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X3R5cGVfdXNlci1kZXNjJyk7XHJcbmV4cG9ydCBjb25zdCBwbGFjZU5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV9wbGFjZS1uYW1lJyk7XHJcbmV4cG9ydCBjb25zdCBwbGFjZUxpbmtJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV9wbGFjZS1saW5rJyk7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJMaW5rSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X3R5cGVfYXZhdGFyLWxpbmsnKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWJ1dHRvbicpO1xyXG5leHBvcnQgY29uc3QgcGhvdG9BZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ1dHRvbicpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFyRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hdmF0YXJfX2VkaXQtcGljJyk7XHJcblxyXG5leHBvcnQgY29uc3QgdG9rZW4gPSBcIjg1ZWNlNmVjLWFkNDItNDU5NS1hYjY0LWY0YWI0NzkxMzg5ZlwiOyIsImltcG9ydCAnLi9pbmRleC5jc3MnO1xyXG5pbXBvcnQgeyBDYXJkIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvY2FyZC5qc1wiO1xyXG5pbXBvcnQgeyBmb3JtVmFsaWRhdG9yIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvZm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgeyBQb3B1cFdpdGhJbWFnZSB9IGZyb20gXCIuLi9jb21wb25lbnRzL3BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCB7IFBvcHVwV2l0aEZvcm0gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9wb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCB7IFBvcHVwV2l0aENvbmZpcm1hdGlvbiB9IGZyb20gXCIuLi9jb21wb25lbnRzL3BvcHVwV2l0aENvbmZpcm1hdGlvbi5qc1wiO1xyXG5pbXBvcnQgeyBVc2VySW5mbyB9IGZyb20gXCIuLi9jb21wb25lbnRzL3VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCB7IFNlY3Rpb24gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9zZWN0aW9uLmpzXCI7XHJcbmltcG9ydCB7IEFwaSB9IGZyb20gXCIuLi9jb21wb25lbnRzL2FwaS5qc1wiO1xyXG5pbXBvcnQge1xyXG4gICAgc2VsZWN0b3JzLFxyXG4gICAgdXNlck5hbWVJbnB1dCxcclxuICAgIHVzZXJEZXNjSW5wdXQsXHJcbiAgICBwbGFjZU5hbWVJbnB1dCxcclxuICAgIHBsYWNlTGlua0lucHV0LFxyXG4gICAgYXZhdGFyTGlua0lucHV0LFxyXG4gICAgcHJvZmlsZUVkaXRCdXR0b24sXHJcbiAgICBwaG90b0FkZEJ1dHRvbixcclxuICAgIGF2YXRhckVkaXRCdXR0b24sXHJcbiAgICB0b2tlblxyXG4gICAgXHJcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5cclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gICAgYmFzZVVybDogJ2h0dHBzOi8vbm9tb3JlcGFydGllcy5jby92MS8nLFxyXG4gICAgaGVhZGVyczoge1xyXG4gICAgICAgICdhdXRob3JpemF0aW9uJzogdG9rZW4sXHJcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgIH1cclxufSlcclxuXHJcbmNvbnN0IHBvcHVwQWRkUGxhY2VWYWxpZGF0aW9uID0gbmV3IGZvcm1WYWxpZGF0b3Ioc2VsZWN0b3JzLCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9hZGQtcGxhY2UnKS5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy5mb3JtU2VsZWN0b3IpKTtcclxuXHJcbmNvbnN0IHBvcHVwRWRpdFByb2ZpbGVWYWxpZGF0aW9uID0gbmV3IGZvcm1WYWxpZGF0b3Ioc2VsZWN0b3JzLCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9lZGl0LXByb2ZpbGUnKS5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy5mb3JtU2VsZWN0b3IpKTtcclxuXHJcbmNvbnN0IHBvcHVwTmV3QXZhdGFyVmFsaWRhdGlvbiA9IG5ldyBmb3JtVmFsaWRhdG9yKHNlbGVjdG9ycywgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfY2hhbmdlLWF2YXRhcicpLnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3JzLmZvcm1TZWxlY3RvcikpO1xyXG5cclxuY29uc3QgdXNlclByb2ZpbGUgPSBuZXcgVXNlckluZm8oJy5wcm9maWxlX191c2VyLW5hbWUnLCAnLnByb2ZpbGVfX3VzZXItZGVzY3JpcHRpb24nLCAnLmF2YXRhcicpO1xyXG5cclxuY29uc3QgcGhvdG9WaWV3UG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoJy5wb3B1cF90eXBlX3Bob3RvLXZpZXcnKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKCcucG9wdXBfdHlwZV9lZGl0LXByb2ZpbGUnLCAoZXZ0KSA9PiB7XHJcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIHJlbmRlckxvYWRpbmcodHJ1ZSwgcHJvZmlsZVBvcHVwLmJ1dHRvbik7XHJcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHByb2ZpbGVQb3B1cC5nZXRJbnB1dFZhbHVlcygpO1xyXG4gICAgYXBpLmVkaXRVc2VySW5mbyhpbnB1dFZhbHVlcylcclxuICAgICAgICAudGhlbihkYXRhID0+IHtcclxuICAgICAgICAgICAgdXNlclByb2ZpbGUuc2V0VXNlckluZm8oW2RhdGEubmFtZSwgZGF0YS5hYm91dCwgZGF0YS5hdmF0YXJdKTtcclxuICAgICAgICAgICAgcmVuZGVyTG9hZGluZyhmYWxzZSwgcHJvZmlsZVBvcHVwLmJ1dHRvbik7XHJcbiAgICAgICAgICAgIHByb2ZpbGVQb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxufSk7XHJcblxyXG5jb25zdCBuZXdQbGFjZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oJy5wb3B1cF90eXBlX2FkZC1wbGFjZScsIChldnQpID0+IHtcclxuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgcmVuZGVyTG9hZGluZyh0cnVlLCBuZXdQbGFjZVBvcHVwLmJ1dHRvbik7XHJcbiAgICBjb25zdCBuZXdQbGFjZUlucHV0cyA9IG5ld1BsYWNlUG9wdXAuZ2V0SW5wdXRWYWx1ZXMoKTtcclxuICAgIGNvbnN0IGFkZGVkQ2FyZCA9IHtcclxuICAgICAgICBuYW1lOiBuZXdQbGFjZUlucHV0c1swXSxcclxuICAgICAgICBsaW5rOiBuZXdQbGFjZUlucHV0c1sxXSxcclxuICAgICAgICB9O1xyXG4gICAgYXBpLnBvc3ROZXdDYXJkKGFkZGVkQ2FyZClcclxuICAgICAgICAudGhlbihkYXRhID0+IHtcclxuICAgICAgICAgICAgY2FyZFNlY3Rpb24uaXRlbXMgPSBbZGF0YV07XHJcbiAgICAgICAgICAgIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XHJcbiAgICAgICAgICAgIHJlbmRlckxvYWRpbmcoZmFsc2UsIG5ld1BsYWNlUG9wdXAuYnV0dG9uKTtcclxuICAgICAgICAgICAgbmV3UGxhY2VQb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxufSk7XHJcblxyXG5jb25zdCBuZXdBdmF0YXJQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKCcucG9wdXBfdHlwZV9jaGFuZ2UtYXZhdGFyJywgKGV2dCkgPT4ge1xyXG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICByZW5kZXJMb2FkaW5nKHRydWUsIG5ld0F2YXRhclBvcHVwLmJ1dHRvbik7XHJcbiAgICBjb25zdCBbbmV3TGlua10gPSBuZXdBdmF0YXJQb3B1cC5nZXRJbnB1dFZhbHVlcygpO1xyXG4gICAgYXBpLnVwZGF0ZUF2YXRhcihuZXdMaW5rKVxyXG4gICAgICAgIC50aGVuKGRhdGEgPT4ge1xyXG4gICAgICAgICAgICB1c2VyUHJvZmlsZS5zZXRVc2VySW5mbyhbZGF0YS5uYW1lLCBkYXRhLmFib3V0LCBkYXRhLmF2YXRhcl0pO1xyXG4gICAgICAgICAgICByZW5kZXJMb2FkaW5nKGZhbHNlLCBuZXdBdmF0YXJQb3B1cC5idXR0b24pO1xyXG4gICAgICAgICAgICBuZXdBdmF0YXJQb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxufSlcclxuXHJcbmNvbnN0IGNvbmZpcm1hdGlvblBvcHVwID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbignLnBvcHVwX3R5cGVfY29uZmlybWF0aW9uJywgKCkgPT4ge30pO1xyXG5cclxubGV0IGNhcmRTZWN0aW9uO1xyXG5cclxubGV0IHVzZXJJZDtcclxuXHJcbmZ1bmN0aW9uIHNldFVzZXJJbmZvKCkge1xyXG4gICAgYXBpLmdldFVzZXJJbmZvKClcclxuICAgICAgICAudGhlbihkYXRhID0+IHtcclxuICAgICAgICAgICAgdXNlclByb2ZpbGUuc2V0VXNlckluZm8oW2RhdGEubmFtZSwgZGF0YS5hYm91dCwgZGF0YS5hdmF0YXJdKTtcclxuICAgICAgICAgICAgdXNlcklkID0gZGF0YS5faWQ7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIGFwaS5nZXRDYXJkc0Zyb21TZXJ2ZXIoKVxyXG4gICAgICAgICAgICAudGhlbihkYXRhID0+IHtcclxuICAgICAgICAgICAgICAgIGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oeyBpdGVtczogZGF0YSwgcmVuZGVyZXI6IChpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjcmVhdGVDYXJkKGl0ZW0pKTtcclxuICAgICAgICAgICAgICAgIH19LCAnLnBsYWNlcycpO1xyXG4gICAgICAgICAgICAgICAgY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG59XHJcblxyXG5zZXRVc2VySW5mbygpO1xyXG5cclxuXHJcblxyXG4vLyDQo9GB0YLQsNC90L7QstC60LAg0YHQu9GD0YjQsNGC0LXQu9C10LlcclxuXHJcbnBob3RvVmlld1BvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbnByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5uZXdQbGFjZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmNvbmZpcm1hdGlvblBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbm5ld0F2YXRhclBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb3BlblByb2ZpbGVQb3B1cCk7XHJcbnBob3RvQWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb3Blbk5ld1BsYWNlUG9wdXApO1xyXG5hdmF0YXJFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb3Blbk5ld0F2YXRhclBvcHVwKTtcclxuXHJcblxyXG4vLyDQlNC+0LHQsNCy0LvQtdC90LjQtSDQstCw0LvQuNC00LDRhtC40LhcclxuXHJcbiBwb3B1cEFkZFBsYWNlVmFsaWRhdGlvbi5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiBwb3B1cEVkaXRQcm9maWxlVmFsaWRhdGlvbi5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiBwb3B1cE5ld0F2YXRhclZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuLy8g0J7RgtC60YDRi9GC0LjQtSDQv9C+0L/QsNC/0L7QslxyXG5cclxuZnVuY3Rpb24gb3BlblByb2ZpbGVQb3B1cCgpIHtcclxuICAgIGxldCBwcm9maWxlSW5mbyA9IHVzZXJQcm9maWxlLmdldFVzZXJJbmZvKCk7XHJcbiAgICB1c2VyTmFtZUlucHV0LnZhbHVlID0gcHJvZmlsZUluZm8ubmFtZTtcclxuICAgIHVzZXJEZXNjSW5wdXQudmFsdWUgPSBwcm9maWxlSW5mby5hYm91dDtcclxuICAgIHBvcHVwRWRpdFByb2ZpbGVWYWxpZGF0aW9uLmhpZGVFcnJvck1lc3NhZ2UodXNlck5hbWVJbnB1dCk7XHJcbiAgICBwb3B1cEVkaXRQcm9maWxlVmFsaWRhdGlvbi5oaWRlRXJyb3JNZXNzYWdlKHVzZXJEZXNjSW5wdXQpO1xyXG4gICAgcG9wdXBFZGl0UHJvZmlsZVZhbGlkYXRpb24udG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgIHByb2ZpbGVQb3B1cC5vcGVuKCk7XHJcbiAgICBcclxufTtcclxuXHJcbmZ1bmN0aW9uIG9wZW5OZXdQbGFjZVBvcHVwKCl7XHJcbiAgICBwb3B1cEFkZFBsYWNlVmFsaWRhdGlvbi5oaWRlRXJyb3JNZXNzYWdlKHBsYWNlTmFtZUlucHV0KTtcclxuICAgIHBvcHVwQWRkUGxhY2VWYWxpZGF0aW9uLmhpZGVFcnJvck1lc3NhZ2UocGxhY2VMaW5rSW5wdXQpO1xyXG4gICAgcG9wdXBBZGRQbGFjZVZhbGlkYXRpb24udG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgIG5ld1BsYWNlUG9wdXAub3BlbigpO1xyXG59O1xyXG5cclxuY29uc3Qgb3BlblBob3RvUG9wdXAgPSAocGhvdG9OYW1lLCBwaG90b0xpbmspID0+IHtcclxuICAgIHBob3RvVmlld1BvcHVwLm9wZW4ocGhvdG9OYW1lLCBwaG90b0xpbmspO1xyXG59O1xyXG5cclxuY29uc3Qgb3BlbkNvbmZpcm1hdGlvblBvcHVwID0gKGNvbmZpcm1lZEFjdGlvbikgPT4ge1xyXG4gICAgY29uZmlybWF0aW9uUG9wdXAuY29uZmlybWVkQWN0aW9uID0gY29uZmlybWVkQWN0aW9uO1xyXG4gICAgY29uZmlybWF0aW9uUG9wdXAub3BlbigpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBvcGVuTmV3QXZhdGFyUG9wdXAoKSB7XHJcbiAgICBwb3B1cE5ld0F2YXRhclZhbGlkYXRpb24uaGlkZUVycm9yTWVzc2FnZShhdmF0YXJMaW5rSW5wdXQpO1xyXG4gICAgcG9wdXBOZXdBdmF0YXJWYWxpZGF0aW9uLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICBuZXdBdmF0YXJQb3B1cC5vcGVuKCk7XHJcbn1cclxuXHJcblxyXG5cclxuLy8g0JTQvtCx0LDQstC70LXQvdC40LUg0LrQsNGA0YLQvtGH0LXQulxyXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGNhcmRJbmZvKSB7XHJcbiAgICBjb25zdCBuZXdDYXJkID0gbmV3IENhcmQoY2FyZEluZm8sICcjcGxhY2UtdGVtcGxhdGUnLCBvcGVuUGhvdG9Qb3B1cCwgb3BlbkNvbmZpcm1hdGlvblBvcHVwLCBsaWtlQ2FyZCwgZGlzbGlrZUNhcmQpO1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBuZXdDYXJkLmNyZWF0ZUNhcmQodXNlcklkKTtcclxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxufVxyXG5cclxuLy8g0JvQsNC50LrQuFxyXG5jb25zdCBsaWtlQ2FyZCA9IChjYXJkSWQpID0+IHtcclxuICAgIHJldHVybiBhcGkubGlrZUNhcmQoY2FyZElkKTtcclxufVxyXG5cclxuY29uc3QgZGlzbGlrZUNhcmQgPSAoY2FyZElkKSA9PiB7XHJcbiAgICByZXR1cm4gYXBpLmRpc2xpa2VDYXJkKGNhcmRJZCk7XHJcbn1cclxuXHJcbi8vINCX0LDQs9GA0YPQt9C60LBcclxuZnVuY3Rpb24gcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGJ1dHRvbkVsZW1lbnQpIHtcclxuICAgIGJ1dHRvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBpc0xvYWRpbmcgPyBcItCh0L7RhdGA0LDQvdC10L3QuNC14oCmXCIgOiBcItCh0L7RhdGA0LDQvdC40YLRjFwiO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwicCIsIkNhcmQiLCJjYXJkIiwidGVtcGxhdGVTZWxlY3RvciIsIm9wZW5QaG90b1BvcHVwRnVuY3Rpb24iLCJvcGVuQ29uZmlybWF0aW9uUG9wdXBGdW5jdGlvbiIsImxpa2VDYXJkRnVuY3Rpb24iLCJkaXNsaWtlQ2FyZEZ1bmN0aW9uIiwidGhpcyIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9jYXJkSWQiLCJfaWQiLCJfb3duZXJJZCIsIm93bmVyIiwiX3VzZXJzTGlrZWQiLCJsaWtlcyIsIl9udW1iZXJPZkxpa2VzIiwibGVuZ3RoIiwiX3RlbXBsYXRlU2VsZWN0b3IiLCJfb3BlblBvcHVwIiwiX29wZW5Db25maXJtYXRpb25Qb3B1cCIsIl9saWtlQ2FyZCIsIl9kaXNsaWtlQ2FyZCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJldnQiLCJ0YXJnZXQiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsInRoZW4iLCJkYXRhIiwicmVtb3ZlIiwibmV4dEVsZW1lbnRTaWJsaW5nIiwidGV4dENvbnRlbnQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJhZGQiLCJpZCIsImdldEVsZW1lbnRCeUlkIiwiaW5uZXJIVE1MIiwiX2xpa2VCdXR0b24iLCJhZGRFdmVudExpc3RlbmVyIiwiX3RvZ2dsZUFjdGl2ZUxpa2UiLCJfZGVsZXRlQnV0dG9uIiwiX2RlbGV0ZUNhcmQiLCJfcGxhY2VwaWMiLCJ1c2VySWQiLCJfZWxlbWVudCIsIl9nZXRUZW1wbGF0ZSIsIl9wbGFjZSIsIl9saWtlc0NvdW50ZXIiLCJzZXRBdHRyaWJ1dGUiLCJmb3JFYWNoIiwidXNlciIsIl9zZXRFdmVudExpc3RlbmVycyIsImZvcm1WYWxpZGF0b3IiLCJzZWxlY3RvcnMiLCJmb3JtRWxlbWVudCIsIl9mb3JtU2VsZWN0b3IiLCJmb3JtU2VsZWN0b3IiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfaW52YWxpZElucHV0Q2xhc3MiLCJpbnZhbGlkSW5wdXRDbGFzcyIsIl9idXR0b25TZWxlY3RvciIsImJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2FjdGl2ZUVycm9yQ2xhc3MiLCJhY3RpdmVFcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwiX2J1dHRvbkVsZW1lbnQiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5wdXRMaXN0Iiwic29tZSIsImVsZW0iLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9nZXRJbnB1dExpc3QiLCJyZW1vdmVBdHRyaWJ1dGUiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJoaWRlRXJyb3JNZXNzYWdlIiwiX3Nob3dFcnJvck1lc3NhZ2UiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9pbnB1dExpc3QiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJwcmV2ZW50RGVmYXVsdCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJidXR0b24iLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5IiwiY2xvc2UiLCJQb3B1cFdpdGhJbWFnZSIsIl9waG90b0VsZW1lbnQiLCJfdGl0bGVFbGVtZW50IiwicGhvdG9OYW1lIiwicGhvdG9MaW5rIiwiUG9wdXBXaXRoRm9ybSIsInN1Ym1pdEZ1bmN0aW9uIiwiX3N1Ym1pdEZ1bmN0aW9uIiwiX3BvcHVwRm9ybSIsImlucHV0VmFsdWVzIiwiaSIsInZhbHVlIiwicmVzZXQiLCJQb3B1cFdpdGhDb25maXJtYXRpb24iLCJjb25maXJtZWRBY3Rpb24iLCJfZXhlY3V0ZUNvbmZpcm1lZEFjdGlvbiIsImV4ZWN1dGVDb25maXJtZWRBY3Rpb24iLCJhY3Rpb24iLCJVc2VySW5mbyIsInVzZXJOYW1lU2VsZWN0b3IiLCJ1c2VyRGVzY3JpcHRpb25TZWxlY3RvciIsInVzZXJBdmF0YXJTZWxlY3RvciIsIl91c2VyTmFtZUVsZW1lbnQiLCJfdXNlckRlc2NyaXB0aW9uRWxlbWVudCIsIl91c2VyQXZhdGFyRWxlbWVudCIsImFib3V0IiwidXNlck5hbWUiLCJ1c2VyRGVzY3JpcHRpb24iLCJ1c2VyQXZhdGFyTGluayIsInN0eWxlIiwiU2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJpdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJBcGkiLCJvcHRpb25zIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX3Rva2VuIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJfY29ob3J0IiwiZmV0Y2giLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwibmV3VXNlck5hbWUiLCJuZXdVc2VyRGVzY3JpcHRpb24iLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsIm5ld0NhcmQiLCJjYXJkSWQiLCJuZXdBdmF0YXJMaW5rIiwiYXZhdGFyIiwidXNlck5hbWVJbnB1dCIsInVzZXJEZXNjSW5wdXQiLCJwbGFjZU5hbWVJbnB1dCIsInBsYWNlTGlua0lucHV0IiwiYXZhdGFyTGlua0lucHV0IiwicHJvZmlsZUVkaXRCdXR0b24iLCJwaG90b0FkZEJ1dHRvbiIsImF2YXRhckVkaXRCdXR0b24iLCJjYXJkU2VjdGlvbiIsImFwaSIsInBvcHVwQWRkUGxhY2VWYWxpZGF0aW9uIiwicG9wdXBFZGl0UHJvZmlsZVZhbGlkYXRpb24iLCJwb3B1cE5ld0F2YXRhclZhbGlkYXRpb24iLCJ1c2VyUHJvZmlsZSIsInBob3RvVmlld1BvcHVwIiwicHJvZmlsZVBvcHVwIiwicmVuZGVyTG9hZGluZyIsImdldElucHV0VmFsdWVzIiwiZWRpdFVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJuZXdQbGFjZVBvcHVwIiwibmV3UGxhY2VJbnB1dHMiLCJhZGRlZENhcmQiLCJwb3N0TmV3Q2FyZCIsInJlbmRlckl0ZW1zIiwibmV3QXZhdGFyUG9wdXAiLCJuZXdMaW5rIiwidXBkYXRlQXZhdGFyIiwiY29uZmlybWF0aW9uUG9wdXAiLCJnZXRVc2VySW5mbyIsImdldENhcmRzRnJvbVNlcnZlciIsImFkZEl0ZW0iLCJvcGVuUGhvdG9Qb3B1cCIsIm9wZW5Db25maXJtYXRpb25Qb3B1cCIsImxpa2VDYXJkIiwiZGlzbGlrZUNhcmQiLCJjcmVhdGVDYXJkIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJwcm9maWxlSW5mbyIsIm9wZW4iLCJlbmFibGVWYWxpZGF0aW9uIiwiaXNMb2FkaW5nIiwiYnV0dG9uRWxlbWVudCJdLCJzb3VyY2VSb290IjoiIn0=